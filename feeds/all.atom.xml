<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Blog Informático</title><link href="https://arpovea.vercel.app/" rel="alternate"></link><link href="https://arpovea.vercel.app/feeds/all.atom.xml" rel="self"></link><id>https://arpovea.vercel.app/</id><updated>2020-10-28T00:00:00+01:00</updated><entry><title>Instalación CMS Drupal y tareas</title><link href="https://arpovea.vercel.app/instalacion-cms-drupal-y-tareas.html" rel="alternate"></link><published>2020-10-28T00:00:00+01:00</published><updated>2020-10-28T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-10-28:/instalacion-cms-drupal-y-tareas.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a realizar la instalación de CMS en PHP concretamente Drupal y distintas configuraciones y tareas.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a realizar la instalación de CMS desarrollados en PHP concretamente Drupal y distintas configuraciones y tareas.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Escenario&lt;/h2&gt;
&lt;p&gt;El escenario para esta práctica se despliega en vagrant-libvirt, a continuación se muestra el contenido de Vagrantfile:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;Vagrant.configure(&amp;quot;2&amp;quot;) do |config|&lt;/span&gt;
&lt;span class="go"&gt;  config.vm.define :server do |server|&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.box = &amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.hostname = &amp;quot;server&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.synced_folder &amp;quot;.&amp;quot;, &amp;quot;/vagrant&amp;quot;, disabled: true&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.network :private_network,&lt;/span&gt;
&lt;span class="go"&gt;   :ip =&amp;gt; &amp;quot;192.168.100.1&amp;quot;,&lt;/span&gt;
&lt;span class="go"&gt;   :libvirt__network_name =&amp;gt; &amp;quot;lan1&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.provision &amp;quot;shell&amp;quot;,&lt;/span&gt;
&lt;span class="go"&gt;   path:&amp;quot;/home/adri/Dropbox/2ASIR/scripLAMP.sh&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   server.vm.provider :libvirt do |server|&lt;/span&gt;
&lt;span class="go"&gt;     server.uri = &amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;     server.host = &amp;quot;server&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;     server.cpus = 1&lt;/span&gt;
&lt;span class="go"&gt;     server.memory = 512&lt;/span&gt;
&lt;span class="go"&gt;   end&lt;/span&gt;
&lt;span class="go"&gt;  end&lt;/span&gt;
&lt;span class="go"&gt;  config.vm.define :bd do |bd|&lt;/span&gt;
&lt;span class="go"&gt;   bd.vm.box = &amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   bd.vm.hostname = &amp;quot;bd&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   bd.vm.synced_folder &amp;quot;.&amp;quot;, &amp;quot;/vagrant&amp;quot;, disabled: true&lt;/span&gt;
&lt;span class="go"&gt;   bd.vm.network :private_network,&lt;/span&gt;
&lt;span class="go"&gt;   :ip =&amp;gt; &amp;quot;192.168.100.2&amp;quot;,&lt;/span&gt;
&lt;span class="go"&gt;   :libvirt__network_name =&amp;gt; &amp;quot;lan1&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;   bd.vm.provider :libvirt do |bd|&lt;/span&gt;
&lt;span class="go"&gt;     bd.uri = &amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;     bd.host = &amp;quot;bd&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;     bd.cpus = 1&lt;/span&gt;
&lt;span class="go"&gt;     bd.memory = 512&lt;/span&gt;
&lt;span class="go"&gt;   end&lt;/span&gt;
&lt;span class="go"&gt;  end&lt;/span&gt;
&lt;span class="go"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Instalación pila LAMP&lt;/h2&gt;
&lt;p&gt;Para poder instalar Drupal previamente hay que tener instalado una serie de requisitos, como por ejemplo una base de datos, modulos de PHP, y el servidor apache2, a todo esto se le llama pila LAMP.&lt;/p&gt;
&lt;p&gt;Para ello se ha realizado un script que realiza:
* Actualización del equipo
* Instala la base de datos mariadb y crea un usuario,una base de datos y consede privilegios
* Instala php y módulos necesarios. 
* Instala apache2 junto a algunos módulos necesarios y crea también un fichero ".php" para poder probar que funciona correctamente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt;! /usr/bin/bash 

&lt;span class="gp"&gt;#&lt;/span&gt;Le agregamos a grub donde queremos que se instale para que no pregunte en la actualización:

&lt;span class="go"&gt;sudo echo &amp;quot;SET grub-pc/install_devices /dev/vda1&amp;quot; | sudo debconf-communicate&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Actualizamos lista de paquetería y actualizamos los paquetes del sistema:

&lt;span class="go"&gt;sudo apt-get update &amp;amp;&amp;amp; sudo apt-get upgrade -y&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Instalamos MariaDB y creamos usuario y base de datos y le damos privilegios:

&lt;span class="go"&gt;sudo apt-get install mariadb-client mariadb-server -y&lt;/span&gt;
&lt;span class="go"&gt;newUser=userdrupal&lt;/span&gt;
&lt;span class="go"&gt;newDbPassword=drupal&lt;/span&gt;
&lt;span class="go"&gt;newDb=bddrupal&lt;/span&gt;
&lt;span class="go"&gt;host=localhost&lt;/span&gt;
&lt;span class="go"&gt;commands=&amp;quot;CREATE DATABASE \`${newDb}\`;CREATE USER &amp;#39;${newUser}&amp;#39;@&amp;#39;${host}&amp;#39; IDENTIFIED BY &amp;#39;${newDbPassword}&amp;#39;;GRANT USAGE ON *.* TO &amp;#39;${newUser}&amp;#39;@&amp;#39;${host}&amp;#39; IDENTIFIED BY &amp;#39;${newDbPassword}&amp;#39;;GRANT ALL privileges ON \`${newDb}\`.* TO &amp;#39;${newUser}&amp;#39;@&amp;#39;${host}&amp;#39;;FLUSH PRIVILEGES;&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;echo &amp;quot;${commands}&amp;quot; | sudo /usr/bin/mysql -u root&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Instalamos php y el módulo de php de mysql:

&lt;span class="go"&gt;sudo apt-get install php7.3 php7.3-mysql -y&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Instalamos apache y el módulo de apache para que interprete php:

&lt;span class="go"&gt;sudo apt-get install apache2 libapache2-mod-php7.3 -y&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Creamos el fichero index.php para hacer la prueba de funcionamiento:

&lt;span class="go"&gt;sudo echo &amp;quot;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;quot; &amp;gt; /var/www/html/index.php&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;Preparación del Virtual Host con apache&lt;/h2&gt;
&lt;p&gt;A continuación se configura apache2 añadiendo un virtualhost para instalar drupal en él, para ello agregamos un fichero en "/etc/apache2/sites-available", con el siguiente contenido:&lt;/p&gt;
&lt;p&gt;Fichero drupal.conf:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;&amp;lt;VirtualHost *:80&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;        ServerName www.arp-drupal.org&lt;/span&gt;
&lt;span class="go"&gt;        ServerAdmin webmaster@localhost&lt;/span&gt;
&lt;span class="go"&gt;        DocumentRoot /var/www/html/drupal&lt;/span&gt;
&lt;span class="go"&gt;        ErrorLog ${APACHE_LOG_DIR}/error.log&lt;/span&gt;
&lt;span class="go"&gt;        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/span&gt;
&lt;span class="go"&gt;        &amp;lt;Directory /var/www/html/drupal&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;                RewriteEngine On&lt;/span&gt;
&lt;span class="go"&gt;                AllowOverride All&lt;/span&gt;
&lt;span class="go"&gt;        &amp;lt;/Directory&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación se descarga drupal y se coloca en su directorio y cambian permisos:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo wget https://www.drupal.org/download-latest/zip&lt;/span&gt;
&lt;span class="go"&gt;sudo unzip zip&lt;/span&gt;
&lt;span class="go"&gt;sudo mv drupal-9.0.7/ drupal&lt;/span&gt;
&lt;span class="go"&gt;sudo chown -R www-data. drupal/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se activa el sitio y un módulo (explicado mas abajo) con: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo a2ensite drupal.conf&lt;/span&gt;
&lt;span class="go"&gt;sudo a2enmod rewrite&lt;/span&gt;
&lt;span class="go"&gt;sudo systemctl restart apache2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;Instalación Drupal&lt;/h2&gt;
&lt;p&gt;Accedemos desde el navegador a la IP o URL si se ha modificado el fichero "/etc/hosts" del anfitrión. Y seguimos lo pasos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Paso 1: Elegir idioma.&lt;/p&gt;
&lt;p&gt;Simplente elegimos el idioma deseado.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paso 2: Elegir perfil.&lt;/p&gt;
&lt;p&gt;Aquí seleccionamos el nivel de instalación que se quiere realizar, ya sea estandar, mínima o una demo. En este caso "mínima"&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paso 3: Verificar requisitos.&lt;/p&gt;
&lt;p&gt;Drupal comprueba que tiene todos los requisitos minimos para funcionar y lanza una serie de errores o advertencias en función de lo que falte en nuestro sistema. Los errores son obligatorios correguirlo mientras que las advertencias no son necesarias arreglarlas, ten en cuenta que es recomendable solucionar todos estas advertencia para tener una experiencia completa de drupal.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Soluciones a Errores y Advertencias:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Extenciones PHP:&lt;ul&gt;
&lt;li&gt;En este caso faltaban unos paquetes que producian un error, los cuales se instalan con:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo apt install php-dompdf php-gd php-xml&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bilioteca UNICODE:&lt;ul&gt;
&lt;li&gt;En este caso faltaba un paquete que provocaba una advertencia:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo apt install php7.3-mbstring&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;URL limpias:&lt;ul&gt;
&lt;li&gt;Para solucionar esta advertencia, se han activado dos opciones en el directorio "drupal" como se puede ver en el fichero "drupal.conf" y activado un módulo:&lt;ul&gt;
&lt;li&gt;Modificación opciones directorio:&lt;ul&gt;
&lt;li&gt;Añade "RewriteEngine On" y "AllowOverride All" como se puede ver en drupal.conf mas arriba.&lt;/li&gt;
&lt;li&gt;Y activamos el módulo y se recarga apache2:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo a2enmod rewrite&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo systemctl restart apache2&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paso 4: Configurar base de datos:&lt;/p&gt;
&lt;p&gt;Aqui se le indica la base de datos a utilizar, en este caso "mariadb", se indica usuario, contraseña y base de datos a utilizar, como opción avanzada se le puede indicar que añada a las tablas una terminología por si la base de datos la utilizan varias aplicaciones, en este caso le indicamos que las marque con la etiqueta "drupal". En este caso la configuración sería:    &lt;/p&gt;
&lt;p&gt;Usuario:userdrupal  &lt;br&gt;
Base de datos: bddrupal  &lt;br&gt;
Contraseña: drupal  &lt;br&gt;
Opcion Avanzada: drupal    &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Paso 5: Configurar Sitio:&lt;/p&gt;
&lt;p&gt;Una vez finaliza la instalación se procede a modificar el sitio, basicamente pide un nombre para el sitio, un correo, y información sobre la cuenta del administrador del sitio así como el país donde se encuentra el sitio. Una vez finalizado realiza unas operaciones y terminaría la instalación de drupal.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2&gt;Modificación Drupal&lt;/h2&gt;
&lt;p&gt;Sin entrar mucho en detalle puesto que no es el objetivo de esta práctica vamos a comentar un par de aspecto como es el cambio de plantilla, y crear un articulo sencillo en el sitio.&lt;/p&gt;
&lt;p&gt;Para el cambio de plantilla, se puede realizar de varias formas, desde una URL del tema seleccionado, o descargando el paquete tar.gz, para ello con el usuario administrador, desde la pestaña "apariencia" y "instalar nuevo tema" como se muestra en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="nuevotema" src="https://arpovea.vercel.app/images/CMS/nuevotema0.png"&gt; 
&lt;img alt="nuevotema1" src="https://arpovea.vercel.app/images/CMS/nuevotema.png"&gt; &lt;/p&gt;
&lt;p&gt;Para crear algun contenido, se realiza desde la pestaña contenido, y luego "añadir contenido", en donde, da varias opciones como "Artículo" o "Página Básica". Con estas opciones creamos nuestro primer artículo como se ve en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="nuevocontenido" src="https://arpovea.vercel.app/images/CMS/nuevocontenido0.png"&gt;
&lt;img alt="nuevocontenido" src="https://arpovea.vercel.app/images/CMS/nuevocontenido.png"&gt;&lt;/p&gt;
&lt;p&gt;Tambien se ha instalado un modulo para facilitar el manejo de la barra de herramientas, para ello desde la página de administración selecciona "ampliar" y luego "instalar nuevo módulo" como se muestra en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="nuevocontenido" src="https://arpovea.vercel.app/images/CMS/nuevomodulo0.png"&gt;
&lt;img alt="nuevocontenido" src="https://arpovea.vercel.app/images/CMS/nuevomodulo1.png"&gt;&lt;/p&gt;
&lt;h2&gt;Configuración Multinodo: Base de datos en otra máquina.&lt;/h2&gt;
&lt;p&gt;Se va a proceder a colocar la base de datos en una máquina distinta, esta máquina estará en la misma red. En la cual unicamente se instalará "mariadb".&lt;/p&gt;
&lt;p&gt;Lo primero a realizar es una copia de seguridad de la base de datos actual del drupal, para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo mysqldump -v --opt --events --routines --triggers --default-character-set=utf8 -u root bddrupal &amp;gt; db_backup_drupal_`date +%Y%m%d_%H%M%S`.sql&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez generada la copia, se pasará a la otra máquina, que tiene instalado previamente "mariadb", se creará la base de datos "bddrupal" y  el usuario "userdrupal" con contraseña "drupal" pero esta vez al crearlo le indicaremos que este usuario puede accerder a la base de datos de forma externa con el siguiente comando desde la consola de "mariadb" con el usuario "root":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;CREATE DATABASE `bddrupal`;&lt;/span&gt;
&lt;span class="go"&gt;CREATE USER &amp;#39;userdrupal&amp;#39; IDENTIFIED BY &amp;#39;drupal&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;GRANT USAGE ON *.* TO &amp;#39;userdrupal&amp;#39;@&amp;#39;%&amp;#39; IDENTIFIED BY &amp;#39;drupal&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;GRANT ALL privileges ON `bddrupal`.* TO &amp;#39;userdrupal&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;FLUSH PRIVILEGES;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto restaurá la copia de la base de datos en la nueva máquina:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;mysql -u root bddrupal &amp;lt; db_backup_drupal_20201028_182650.sql&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto hay que configurar a Drupal para que busque la base de datos en la otra máquina para ello en la máquina donde esta instalado Drupal modifica el fichero de configuración "/var/www/html/drupal/sites/default/settings.php" quedando asi:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt; $&lt;/span&gt;databases&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; array &lt;span class="o"&gt;(&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;database&amp;#39; =&amp;gt; &amp;#39;bddrupal&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;username&amp;#39; =&amp;gt; &amp;#39;userdrupal&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;password&amp;#39; =&amp;gt; &amp;#39;drupal&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;prefix&amp;#39; =&amp;gt; &amp;#39;drupal&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;host&amp;#39; =&amp;gt; &amp;#39;192.168.100.2&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;port&amp;#39; =&amp;gt; &amp;#39;3306&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;namespace&amp;#39; =&amp;gt; &amp;#39;Drupal\\Core\\Database\\Driver\\mysql&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;  &amp;#39;driver&amp;#39; =&amp;gt; &amp;#39;mysql&amp;#39;,&lt;/span&gt;
&lt;span class="go"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tambien hay que indicarle a "mariadb" que acepte acceso remoto para ello modifica el fichero de configuración "/etc/mysql/mariadb.conf.d/50-server.cnf" comentando la siguiente linea:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; bind-address            &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ó indicandole acceso desde cualquier sitio:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;bind-address            = 0.0.0.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reinicia el servicio de mariadb para que recarge la configuración:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;systemctl restart mariadb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto se puede borrar la base de datos de la máquina donde esta drupal, para ellos desde la consola de mariadb:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;drop database bddrupal;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ó tambien se puede realizar la desistalacíon de mariadb, para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo apt purge mariadb*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Instalación de un segundo CMS&lt;/h2&gt;
&lt;p&gt;A continuación se va a instalar Joomla! para ello se creará otro virtualhost llamado joomla.conf con el siguiente contenido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;&amp;lt;VirtualHost *:80&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;        ServerName www.arp-joomla.org&lt;/span&gt;
&lt;span class="go"&gt;        ServerAdmin webmaster@localhost&lt;/span&gt;
&lt;span class="go"&gt;        DocumentRoot /var/www/html/joomla&lt;/span&gt;
&lt;span class="go"&gt;        ErrorLog ${APACHE_LOG_DIR}/error.log&lt;/span&gt;
&lt;span class="go"&gt;        CustomLog ${APACHE_LOG_DIR}/access.log combined&lt;/span&gt;
&lt;span class="go"&gt;        &amp;lt;Directory /var/www/html/joomla&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;                RewriteEngine On&lt;/span&gt;
&lt;span class="go"&gt;                AllowOverride All&lt;/span&gt;
&lt;span class="go"&gt;        &amp;lt;/Directory&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;También se le va a crear otro usuario y base de datos a Joomla! para ello en la máquina que esta "mariadb", de nuevo en la consola de "mariadb":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;CREATE DATABASE `bdjoomla`;&lt;/span&gt;
&lt;span class="go"&gt;CREATE USER &amp;#39;userjoomla&amp;#39; IDENTIFIED BY &amp;#39;joomla&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;GRANT USAGE ON *.* TO &amp;#39;userjoomla&amp;#39;@&amp;#39;%&amp;#39; IDENTIFIED BY &amp;#39;joomla&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;GRANT ALL privileges ON `bdjoomla`.* TO &amp;#39;userjoomla&amp;#39;;&lt;/span&gt;
&lt;span class="go"&gt;FLUSH PRIVILEGES;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto, accede a la URL del sitio y comienza la instalación, es muy parecida a la de drupal, la única diferencia es que puedes elegir unas plantillas por defecto y al final de la instalación pide borrar la carpeta "installation", los demas pasos son iguales, pedirá usuario y sus datos, y los datos de la base de datos, que en este caso no esta en "localhost" sino en la IP "192.168.100.2", al finalizar Joomla estará disponible.&lt;/p&gt;
&lt;p&gt;&lt;img alt="joomla" src="https://arpovea.vercel.app/images/CMS/joomla.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.    &lt;/p&gt;</content><category term="Implantación Web"></category></entry><entry><title>Cambio de Arquitectura</title><link href="https://arpovea.vercel.app/cambio-de-arquitectura.html" rel="alternate"></link><published>2020-10-15T00:00:00+02:00</published><updated>2020-10-15T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-10-15:/cambio-de-arquitectura.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a realizar el cambio de una arquitectura amd64 a una arquitectura i386&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a realizar el cambio de una arquitectura amd64 a una arquitectura i386 por completo, se va a utilizar una máquina con un sistema Debian Buster(amd64).&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Cambio de Arquitectura (De amd64 a i386):&lt;/h2&gt;
&lt;p&gt;Lo primero que se va a realizar es una actualización de todos los paquetes de nuestro equipo a su última versión estable, para ello,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade -y
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Agregar arquitectura i386.&lt;/h3&gt;
&lt;p&gt;Para ello utiliza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --add-architecture i386
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Luego actualiza la lista de paquetes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Instalación de paquetes&lt;/h3&gt;
&lt;p&gt;Se van a descargar estos paquetes con "apt" y instalar con "dpkg", ya que "apt" al instalar paquetes de una arquitectura borra el de la anterior arquitectura, lo que provoca que el sistema se rompa.&lt;/p&gt;
&lt;p&gt;Los paquetes descargados se almacenan en "/var/cache/apt/archives/" por lo que interesa tener este directorio limpio, para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get clean
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez limpio el directorio, realiza la descarga los paquetes de los distintos instaladores en su versión i386 esto provocará el cambio de arquitectura principal:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get -y --no-install-recommends --download-only install dpkg:i386 apt:i386 aptitude:i386 apt-utils:i386
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Luego instálalos con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --install /var/cache/apt/archives/*.deb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Si da problemas al procesar recuerda intentar de nuevo la instalación, si da problemas de configuración realiza: &lt;code&gt;sudo dpkg --configure -a&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Una vez instalados estos dara problemas de dependencias, para arreglar esto utiliza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get --fix-broken install -y --allow-remove-essential
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación descarga todos los paquetes amd64 pero con la versión i386, menos el kernel:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get --download-only -y --no-install-recommends install &lt;span class="sb"&gt;`&lt;/span&gt;dpkg -l &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="s1"&gt;&amp;#39;^.i&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print $2}&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep :amd64 &lt;span class="p"&gt;|&lt;/span&gt; egrep -v &lt;span class="s1"&gt;&amp;#39;linux-image-.*&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/:amd64/:i386/g&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ahora instala las librerías y perl (esto suele reducir los errores):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --install /var/cache/apt/archives/lib*.deb /var/cache/apt/archives/perl*.deb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Realiza el siguiente comando para asegurar que no hay ningún paquete sin configurar: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --configure -a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Instala los demás paquetes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --install /var/cache/apt/archives/*.deb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Recuerda realizar de nuevo la instalación si algún paquete da error, sobre todo de dependencias.&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;Borrado de paquetes amd64 y instalacion del kernel i386&lt;/h3&gt;
&lt;p&gt;Una vez instalados todos los paquetes de la arquitectura i386, solo queda borrar los paquetes de amd64 y instalar el kernel i386.&lt;/p&gt;
&lt;p&gt;Realiza el siguiente comando para borrar los paquetes que no son necesarios en el sistema:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get autoremove -y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ahora instala el kernel i386:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install -y linux-image-686
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación reinicia el equipo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo reboot
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Comprueba que está el nuevo kernel funcionando con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;uname -r
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Aquí puede ocurrir que esté una versión "cloud" del kernel amd64, pero no hay problema, como ya hay una entrada en "/boot/initrd.img-4.19.0-11-686" al haber realizado la instalación del otro kernel (i386), en el siguiente paso que se eliminan todos los paquetes amd64 incluido estos kernel, se sustituirá automáticamente por el de i386.&lt;/p&gt;
&lt;p&gt;Una vez este el kernel i386 instalado borra todos los paquetes amd64:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get remove -y &lt;span class="sb"&gt;`&lt;/span&gt;dpkg -l &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="s1"&gt;&amp;#39;^.i&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; awk &lt;span class="s1"&gt;&amp;#39;{print $2}&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep :amd64&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reinicia el equipo para asegurar el cambio de kernel si fuera necesario.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo reboot
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Borrado de la arquitectura amd64&lt;/h3&gt;
&lt;p&gt;Una vez realizado todo lo anterior se puede remover la arquitectura amd64 con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dpkg --remove-architecture amd64
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con esto el equipo quedará trasnformado por completo a una arquitectura i386.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.&lt;/p&gt;</content><category term="Sistemas"></category></entry><entry><title>Criptografía: GPG y OPENSSL</title><link href="https://arpovea.vercel.app/criptografia-gpg-y-openssl.html" rel="alternate"></link><published>2020-10-15T00:00:00+02:00</published><updated>2020-10-15T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-10-15:/criptografia-gpg-y-openssl.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se van a realizar una serie de pruebas con GPG y OPENSSL.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se van a realizar una serie de pruebas con GPG y OPENSSL.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;GPG&lt;/h2&gt;
&lt;h4&gt;Creación de claves pública y privada:&lt;/h4&gt;
&lt;p&gt;Para ello se realiza el siguiente comando, el cual te realizará una serie de preguntas:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --gen-key&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Si quieres crearla con mas detalles y diálogo realiza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --full-generate-key&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Al final mostrará algo como esto:&lt;/p&gt;
&lt;p&gt;&lt;img alt="clavepubl" src="https://arpovea.vercel.app/images/Criptografía/clavepublicaadri.png"&gt; &lt;/p&gt;
&lt;p&gt;Todo lo referente a las claves "GPG" esta en el directorio "~/.gnupg" de cada usuario.&lt;/p&gt;
&lt;p&gt;Para listar las claves públicas utiliza el comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --list-keys&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Los datos mostrados son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;El tipo de clave y el sistema de criptografía que tiene. Por ejemplo "rsa4096".&lt;/li&gt;
&lt;li&gt;El uid, número que identifica la clave, para identificarla se pueden utilizar los últimos 8 dígitos.&lt;/li&gt;
&lt;li&gt;El nombre del propietario junto con su correo y comentario si dispone de él.&lt;/li&gt;
&lt;li&gt;Confianza que se tiene sobre esa clave.&lt;/li&gt;
&lt;li&gt;Fecha de validez si dispone de ella.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para darle fecha de validez a la clave, cuando se genera la clave con "gpg --gen-key" o "gpg --full-generate-key" preguntará algo como esto:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;Por favor, especifique el período de validez de la clave.&lt;/span&gt;
&lt;span class="go"&gt;         0 = la clave nunca caduca&lt;/span&gt;
&lt;span class="go"&gt;      &amp;lt;n&amp;gt;  = la clave caduca en n días&lt;/span&gt;
&lt;span class="go"&gt;      &amp;lt;n&amp;gt;w = la clave caduca en n semanas&lt;/span&gt;
&lt;span class="go"&gt;      &amp;lt;n&amp;gt;m = la clave caduca en n meses&lt;/span&gt;
&lt;span class="go"&gt;      &amp;lt;n&amp;gt;y = la clave caduca en n años&lt;/span&gt;
&lt;span class="go"&gt;¿Validez de la clave (0)? 1M&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En el ejemplo de arriba al final se le asignó 1 mes.&lt;/p&gt;
&lt;p&gt;Para ver las claves privadas:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --list-secret-keys&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Importar y Exportar claves públicas.&lt;/h4&gt;
&lt;p&gt;A continuación se mostrarán los comandos para exportar una clave pública en formato ASCII. Para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gpg&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;uid_o_nombre usuario&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;clavepublica&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como se muestra en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="exportclavepub" src="https://arpovea.vercel.app/images/Criptografía/expportarclavepub.png"&gt; &lt;/p&gt;
&lt;p&gt;A continuación se mostrarán los comando para importar la clave de un compañero a nuestro anillo de claves:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gpg&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pepito_perez.asc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como se muestra en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="importpepito" src="https://arpovea.vercel.app/images/Criptografía/importpepito.png"&gt; &lt;/p&gt;
&lt;h4&gt;Cifrado y Descifrado de documentos&lt;/h4&gt;
&lt;p&gt;A continuación se muestran los comandos para cifrar y descifrar documentos:&lt;/p&gt;
&lt;p&gt;Para cifrar un documento:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg -e mensaje.txt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esto pedirá el uid del destinatario en nuestro caso el de Pepito Pérez, en la siguiente imagen se muestra todo el proceso y el fichero "mensaje.txt.gpg":&lt;/p&gt;
&lt;p&gt;&lt;img alt="gpgcifrado" src="https://arpovea.vercel.app/images/Criptografía/gpgcifrado.png"&gt; &lt;/p&gt;
&lt;p&gt;También se puede utilizar el comando con argumentos para que no sea de forma interactiva:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg -e -u &amp;quot;Adrian Rodriguez&amp;quot; -r &amp;quot;pepito perez&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Cualquiera que no esté en la lista al crear el mensaje cifrado, no puede descifrarlo. Le lanzará un mensaje de error del estilo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gpg&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;descifrado&lt;/span&gt; &lt;span class="n"&gt;fallido&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez Pepito tiene el mensaje cifrado utiliza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg -o mensaje.txt -d mensaje.txt.gpg &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Al realizar este comando si tiene contraseña, la pedirá y luego descifrará el mensaje. Como se muestra en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="gpgdescrifrado" src="https://arpovea.vercel.app/images/Criptografía/decryptmens.png"&gt;&lt;/p&gt;
&lt;h4&gt;Borrar claves públicas o privadas:&lt;/h4&gt;
&lt;p&gt;Para borrar las claves públicas utiliza el comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --delete-key &amp;quot;uid_o_nombreusuario&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para borrar las claves privadas utiliza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --delete-secret-key &amp;quot;uid_onombreusuario&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Exportar clave a un servidor público de claves PGP&lt;/h4&gt;
&lt;p&gt;Lo primero que se va a realizar es la clave de revocación por si existe algun problema con la clave, para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg -gen-revoke &amp;quot;uid_o_nombreusuarito&amp;quot; &amp;gt; cert_revoc.asc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;También se puede utilizar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --output cer_revoc.asc --gen-revoke &amp;quot;uid_o_nombreusuario&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Al realizar estos comandos preguntará la razón de la revocación como se muestra a continuación:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;¿Crear un certificado de revocación para esta clave? (s/N) s&lt;/span&gt;
&lt;span class="err"&gt;Por favor elija una razón para la revocación:&lt;/span&gt;
&lt;span class="err"&gt;  0 = No se dio ninguna razón&lt;/span&gt;
&lt;span class="err"&gt;  1 = La clave ha sido comprometida&lt;/span&gt;
&lt;span class="err"&gt;  2 = La clave ha sido reemplazada&lt;/span&gt;
&lt;span class="err"&gt;  3 = La clave ya no está en uso&lt;/span&gt;
&lt;span class="err"&gt;  Q = Cancelar&lt;/span&gt;
&lt;span class="err"&gt;(Probablemente quería seleccionar 1 aquí)&lt;/span&gt;
&lt;span class="err"&gt;¿Su decisión? 1&lt;/span&gt;
&lt;span class="err"&gt;Introduzca una descripción opcional; acábela con una línea vacía:&lt;/span&gt;
&lt;span class="err"&gt;&amp;gt; &lt;/span&gt;
&lt;span class="err"&gt;Razón para la revocación: La clave ha sido comprometida&lt;/span&gt;
&lt;span class="err"&gt;(No se dió descripción)&lt;/span&gt;
&lt;span class="err"&gt;¿Es correcto? (s/N) s&lt;/span&gt;
&lt;span class="err"&gt;se fuerza salida con armadura ASCII.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para utilizar esto solo hay que importar el certificado generado y se anulará la clave, si está en un servidor público hay que volver a subirla una vez revocada.&lt;/p&gt;
&lt;p&gt;Una vez se ha generado el certificado de revocación estos son los comandos necesarios para subir tu clave pública a un servidor, en este caso "pgp.rediris.es":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --keyserver gpg.rediris.es --send-keys D4BB0593 &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para importar una clave de un servidor:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;gpg --recv-keys --keyserver pgp.rediris.es D4BB0593&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En las siguientes imágenes se muestra como un usuario, sube la clave y otro importa esta clave desde el servidor:&lt;/p&gt;
&lt;p&gt;&lt;img alt="subirclaveserv" src="https://arpovea.vercel.app/images/Criptografía/subirclave.png"&gt;
&lt;img alt="importarclaveserv" src="https://arpovea.vercel.app/images/Criptografía/importarclave.png"&gt;&lt;/p&gt;
&lt;h2&gt;Cifrado OPENSSL&lt;/h2&gt;
&lt;p&gt;A continuación se muestran los comandos para crear una clave privada en openssl y generar una clave pública de la clave privada.&lt;/p&gt;
&lt;p&gt;Crear clave privada:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl genrsa -out key.pem 2048&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Crear clave pública:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsa -in key.pem -pubout -out key.public.pem&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se puede también encriptar la clave privada con una contraseña con el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsa -in key.pem -des3 -out enc-key.pem&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para cifrar un documento(Con la clave pública del destinatario):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsautl -encrypt -inkey pub-key.pem -pubin -in mensaje.txt -out mensaje.txt.enc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para descifrar un mensaje sería lo mismo pero en el destinatario utilizando su clave privada:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsautl -decrypt -inkey key.pem -in mensaje..txt.enc -out mensaje.txt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación se muestra un ejemplo en las siguientes imagenes:&lt;/p&gt;
&lt;p&gt;&lt;img alt="openssl1" src="https://arpovea.vercel.app/images/Criptografía/openssl1.png"&gt;
&lt;img alt="openssl2" src="https://arpovea.vercel.app/images/Criptografía/openssl2.png"&gt;&lt;/p&gt;
&lt;p&gt;Como dato extra también es posible cifrar con la clave privada y que descifren con la clave pública aunque es menos utilizado:&lt;/p&gt;
&lt;p&gt;Cifrado con clave privada:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsautl -inkey key.pem -in mensaje.txt -sign &amp;gt; mensaje.txt.enc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Descifrado con clave pública:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;openssl rsautl -inkey pub-key.pem -pubin -in mensaje.txt.enc -out mensaje.txt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="Seguridad"></category></entry><entry><title>Configuración DHCP y Tareas</title><link href="https://arpovea.vercel.app/configuracion-dhcp-y-tareas.html" rel="alternate"></link><published>2020-10-08T00:00:00+02:00</published><updated>2020-10-08T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-10-08:/configuracion-dhcp-y-tareas.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a realizar la instalación de un servidor DHCP, en un escenario creado con Vagrant, se van a realizar distintas configuraciones y pruebas.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a realizar la instalación de un servidor DHCP, en un escenario creado con Vagrant, se van a realizar distintas configuraciones y pruebas.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Un poco de Teoría&lt;/h2&gt;
&lt;p&gt;&lt;img alt="graficodhcp" src="https://arpovea.vercel.app/images/DHCP/graficodhcp.png"&gt;&lt;/p&gt;
&lt;p&gt;La anterior imagen refleja el comportamiento que tiene el cliente y el servidor en cuánto a la demanda y oferta de IPs en las distintas situaciones por las que pasan, a continuación se explicará cada una de estas fases.&lt;/p&gt;
&lt;p&gt;Cuanto se inicia el cliente esta en modo INIT, este realiza una petición (DHCPDISCOVER) al broadcast (255.255.255.255) ya que no tiene configuración IP, después de enviar esta petición el cliente pasa al estado SELECTING, donde recibe los mensajes (DHCPOFFER) de los servidores DHCP, entonces el cliente envía un mensaje (PREREQUEST) para elegir el servidor DHCP, el cual contestará con un (DHCPACK) el cual contiene una IP, el cliente en este momento comprueba que esa IP no la tenga nadie en la red, mediante un mensaje al brodcast preguntando por esa IP, si alguien contesta descarta la IP mandando al DHCP un mensaje (DHCPDECLINE) con lo cual el cliente vuelve al estado INIT, de lo contrario si nadie contesta el cliente acepta el (DHCPACK) y el servidor confirma la concesión con un (ACK) y el cliente pasa al estado BOUND.&lt;/p&gt;
&lt;p&gt;En el DHCPACK que envía el servidor se manda la siguiente información aparte de la IP:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;T1 es el temporizador de renovación de alquiler.&lt;/li&gt;
&lt;li&gt;T2 es el temporizador de reenganche.&lt;/li&gt;
&lt;li&gt;T3 es la duración del alquiler.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El estado de RENEWING ocurre una vez que el tiempo de T1 expira, el cliente pasa a este estado, en el cual el cliente tiene que negociar la renovación del alquiler de la IP actual, si por alguna razón el servidor no renueva el alquiler le manda un mensaje (DHCPNACK) al cliente y este pasa de nuevo a fase INIT para obtener de nuevo otra dirección, en caso contrario el servidor manda un mensaje (DHCPACK) con los nuevos tiempos, y el cliente toma estos valores y se mueve al estado BOUND.&lt;/p&gt;
&lt;p&gt;El estado REBINDING ocurre una vez que el tiempo de T2 expira, en este momento el cliente comienza a enviar (DHCPREQUEST) al brodcast, asumiendo que pasado el tiempo de T2 el servidor DHCP original no esta disponible, buscando alguien que le renueve el alquiler actual, si algun otro DHCP contesta con un (DHCPACK), el cliente toma los valores y vuelve al estado BOUND, en caso de que nadie contesta el alquiler cesa y vuelve al estado INIT.&lt;/p&gt;
&lt;p&gt;Al expirar la concesión el cliente debe devolver la IP y cesar todas las acciones con dicha IP, hay que recalcar que el cliente no siempre tiene que esperar la expiración del alquiler, él, en cualquier momento, puede renunciar a una dirección IP cancelando su alquiler. Esto se realiza por ejemplo cuando un equipo de desconecta de la red antes del tiempo de expiración del alquiler, en esta situación el cliente manda un mensaje (DHCPRELEASE) al servidor DHCP para cancelar el alquiler, quedando esa IP libre.&lt;/p&gt;
&lt;p&gt;Si los clientes DHCP estan en ordenadores que tienen disco duro, la dirección IP asignada puede ser almacenada en este dispositivo y, cuando reinicie sus operaciones, puede hacer una nueva petición usando esta dirección IP.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Preparación del escenario&lt;/h2&gt;
&lt;p&gt;El escenario se va a realizar con Vagrant utilizando libvirt para la virtualización. Se van a definir dos máquinas, una donde se instalará el servidor DHCP y otra que servirá como cliente.&lt;/p&gt;
&lt;p&gt;El servidor DHCP tendrá en un principio dos interfaces de red, una pública con salida a internet y otra privada en la cual repartirá direcciones del rango &lt;code&gt;192.168.100.0/24&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Previamente se han creado las redes "lan1" y "lan2" que serán necesarias para las pruebas a realizar, esto se ha hecho con la ayuda de &lt;code&gt;virsh&lt;/code&gt; y ficheros "xml" para configurar estas redes. A continuación se muestra el contenido de estos ficheros:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lan1:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;network&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;name&amp;gt;&lt;/span&gt;lan1&lt;span class="nt"&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;bridge&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;virbr2&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;ip&lt;/span&gt; &lt;span class="na"&gt;address=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;192.168.100.1&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;netmask=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;255.255.255.0&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/network&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;lan2:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;network&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;name&amp;gt;&lt;/span&gt;lan2&lt;span class="nt"&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;bridge&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;virbr3&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;ip&lt;/span&gt; &lt;span class="na"&gt;address=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;192.168.200.1&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;netmask=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;255.255.255.0&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/network&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Así como &lt;code&gt;br0&lt;/code&gt; en el fichero &lt;code&gt;etc/network/interfaces&lt;/code&gt; de la máquina anfitrión:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;auto br0&lt;/span&gt;
&lt;span class="go"&gt;iface br0 inet dhcp&lt;/span&gt;
&lt;span class="go"&gt;bridge_ports enp61s0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación se expone el contenido del fichero Vagrantfile:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="no"&gt;Vagrant&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="ss"&gt;:dhcp&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dhcp&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;synced_folder&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/vagrant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kp"&gt;true&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:public_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:dev&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;br0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:type&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;bridge&amp;#39;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:ip&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;192.168.100.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan1&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provision&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;sudo ip r del default via 192.168.121.1 dev ens5&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debianserver&amp;quot;&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;
   &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="ss"&gt;:clinux&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;clinux&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;synced_folder&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/vagrant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kp"&gt;true&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__dhcp_enabled&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;false&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provision&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;sudo ip r del default via 192.168.121.1 dev ens5&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debiancliente1&amp;quot;&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;
   &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como se puede observar en esta configuración, se borra la ruta de encaminamiento que crea vagrant por defecto, para que salga exclusivamente por la que se ha especificado.También se modifica el fichero &lt;code&gt;resolv.conf&lt;/code&gt; para indicarle el servidor DNS, esto una vez la máquina del servidor esta arrancada.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Instalación y configuración del servidor DHCP&lt;/h2&gt;
&lt;p&gt;Una vez iniciado el escenario, accede a la máquina &lt;code&gt;dhcp&lt;/code&gt; donde se instalará el servidor DHCP. Para ello:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo apt update &amp;amp;&amp;amp; sudo apt install isc-dhcp-server&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Al instalarlo el servicio fallará y mandará un mensaje de error, pero es normal ya que aún no está configurado.&lt;/p&gt;
&lt;p&gt;El primer fichero que hay que editar es &lt;code&gt;/etc/default/isc-dhcp-server&lt;/code&gt; en el cual se indica la interfaz de red donde va a trabajar el servidor DHCP. Dejandolo así:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;INTERFACESv4="ens7"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Una vez realizado esto el fichero de configuración principal del DHCP es &lt;code&gt;/etc/dhcp/dhcpd.conf&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Edita el fichero dejando la siguiente configuración:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;ddns-update-style none;&lt;/span&gt;
&lt;span class="go"&gt;autoritative;&lt;/span&gt;

&lt;span class="go"&gt;subnet 192.168.100.0 netmask 255.255.255.0 {&lt;/span&gt;
&lt;span class="go"&gt; range 192.168.100.2 192.168.100.254;&lt;/span&gt;
&lt;span class="go"&gt; max-lease-time 43200;&lt;/span&gt;
&lt;span class="go"&gt; default-lease-time 600;&lt;/span&gt;
&lt;span class="go"&gt; option subnet-mask 255.255.255.0;&lt;/span&gt;
&lt;span class="go"&gt; option broadcast-address 192.168.100.255;&lt;/span&gt;
&lt;span class="go"&gt; option routers 192.168.100.1;&lt;/span&gt;
&lt;span class="go"&gt; option domain-name-servers 192.168.1.1;&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Recalcar que se ha asignado un tiempo corto de renovación, para comprobar los cambios en el escenario en las distintas pruebas.&lt;/p&gt;
&lt;p&gt;Una vez realizado estos cambios hay que reiniciar el servidor DHCP:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo sistemctl restart isc-dhcp-server&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Con esto el servidor ya debe de repartir las direcciones en "lan1".&lt;/p&gt;
&lt;p&gt;La lista de concesiones del servidor se puede mirar en fichero &lt;code&gt;/var/lib/dhcp/dhcp.leases&lt;/code&gt; realizando por ejemplo el siguiente comando se puede observar la última concesión:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tail /var/lib/dhcp/dhcpd.leases&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;En este caso muestra la siguiente información:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ultimaconsesión" src="https://arpovea.vercel.app/images/DHCP/ultimaconcesion.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Configuración en el cliente.&lt;/h2&gt;
&lt;p&gt;En el cliente modifica el fichero &lt;code&gt;/etc/network/interfaces&lt;/code&gt; dejándolo así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;auto ens6&lt;/span&gt;
&lt;span class="go"&gt;iface ens6 inet dhcp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reinicia el servicio "networking" en el cliente:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl restart networking&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;También puedes solicitar una IP, realiza el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo dhclient ens6&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Obteniendo la siguiente IP:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ipclinux" src="https://arpovea.vercel.app/images/DHCP/ipclinux.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Configuración del servidor para que los clientes realizen NAT&lt;/h2&gt;
&lt;p&gt;Para ello hay que realizar dos tareas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Activar el bit de enrutamiento en el fichero &lt;code&gt;/etc/sysctl.conf&lt;/code&gt; Para ello:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo nano /etc/sysctl.conf&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Y descomenta la siguiente línea:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;net.ipv4.ip_forward=1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Y luego:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo sysctl -p&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Crear la ruta de IPTABLES. Para ello:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo iptables -t nat -A POSTROUTING -s 192.168.100.0/24 -o ens6 -j MASQUERADE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;A continuación reinicia el servicio:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo systemctl restart networking&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Una vez realizado esto el servidor queda configurado para que el cliente pueda salir a internet realizando NAT, en las siguientes imagenes se puede comprobar las configuraciones realizadas y la navegación del cliente:&lt;/p&gt;
&lt;p&gt;&lt;img alt="iprdhcp" src="https://arpovea.vercel.app/images/DHCP/iprdhcp.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="iprclinux" src="https://arpovea.vercel.app/images/DHCP/capturaiprclinux.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="tracerouteclinux" src="https://arpovea.vercel.app/images/DHCP/capturatracrouteclinux.png"&gt;&lt;/p&gt;
&lt;p&gt;A continuación se realiza una captura de los paquetes que corresponden a una concesión utilizando el comando &lt;code&gt;tcpdum&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo tcpdump -i ens7 -pvn port 67 and port 68&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="tcpdump" src="https://arpovea.vercel.app/images/DHCP/tcpdump.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Pruebas a realizar con el escenario y los clientes&lt;/h2&gt;
&lt;h4&gt;Los clientes toman una configuración, y a continuación apagamos el servidor dhcp. ¿Qué ocurre con el cliente windows? ¿Y con el cliente linux?&lt;/h4&gt;
&lt;p&gt;A continuación dejo un video en el que se explica lo ocurrido:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.youtube.com/watch?v=5x13rKnYLYE" title=""&gt;&lt;img alt="Tarea6" src="http://img.youtube.com/vi/5x13rKnYLYE/0.jpg"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Los clientes toman una configuración, y a continuación cambiamos la configuración del servidor dhcp (por ejemplo el rango). ¿Qué ocurriría con un cliente windows? ¿Y con el cliente linux?&lt;/h4&gt;
&lt;p&gt;A continuación dejo un video en el que se explica lo ocurrido:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.youtube.com/watch?v=LEzdYdzjwqg" title=""&gt;&lt;img alt="Tarea7" src="http://img.youtube.com/vi/LEzdYdzjwqg/0.jpg"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Creando reservas en el servidor DHCP&lt;/h2&gt;
&lt;p&gt;Para crear una reserva se añade la siguiente información al fichero &lt;code&gt;/etc/dhcp/dhcpd.conf&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;host clinux {&lt;/span&gt;
&lt;span class="go"&gt;hardware ethernet 52:54:00:20:cb:8f;&lt;/span&gt;
&lt;span class="go"&gt;fixed-address 192.168.100.100;&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como se puede observar necesitaras la dirección MAC de la tarjeta del cliente.&lt;/p&gt;
&lt;p&gt;Una vez realizados los cambios se reinicia el servidor y pasado el tiempo de renovación, esta cambiará la IP.&lt;/p&gt;
&lt;p&gt;&lt;img alt="reserva" src="https://arpovea.vercel.app/images/DHCP/reserva.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Configurar varios ambitos&lt;/h2&gt;
&lt;p&gt;Para esto hay que modificar el "Vagrantfile" del escenario y agregar nuevas conexiones quedando así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="no"&gt;Vagrant&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="ss"&gt;:dhcp&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dhcp&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;synced_folder&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/vagrant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kp"&gt;true&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:public_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:dev&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;br0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:type&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;bridge&amp;#39;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:ip&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;192.168.100.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan1&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:ip&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;192.168.200.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan2&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provision&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;sudo ip r del default via 192.168.121.1 dev ens5&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debianserver&amp;quot;&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="n"&gt;dhcp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;
   &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="ss"&gt;:clinux&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;clinux&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;synced_folder&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/vagrant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kp"&gt;true&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__dhcp_enabled&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;false&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provision&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;sudo ip r del default via 192.168.121.1 dev ens5&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debiancliente1&amp;quot;&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="n"&gt;clinux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;
   &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="ss"&gt;:clinux2&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;clinux2&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;synced_folder&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/vagrant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;disabled&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kp"&gt;true&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="ss"&gt;:private_network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__network_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;lan2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;:libvirt__dhcp_enabled&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;false&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provision&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
   &lt;span class="ss"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;sudo ip r del default via 192.168.121.1 dev ens5&amp;quot;&lt;/span&gt;
   &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
     &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;qemu+unix:///system&amp;#39;&lt;/span&gt;
     &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debiancliente2&amp;quot;&lt;/span&gt;
     &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cpus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="n"&gt;clinux2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;
   &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En el servidor hay que agregar la nueva interfaz por la cual se va a repartir direcciones editando de nuevo el fichero &lt;code&gt;/etc/default/isc-dhcp-server&lt;/code&gt;, quedando así:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;INTERFACESv4="ens7 ens8"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A continuación agregar el nuevo ámbito en el fichero &lt;code&gt;/etc/dhcp/dhcpd.conf&lt;/code&gt;, quedando así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;ddns-update-style none;&lt;/span&gt;
&lt;span class="go"&gt;autoritative;&lt;/span&gt;

&lt;span class="go"&gt;subnet 192.168.100.0 netmask 255.255.255.0 {&lt;/span&gt;
&lt;span class="go"&gt; range 192.168.100.2 192.168.100.254;&lt;/span&gt;
&lt;span class="go"&gt; max-lease-time 43200;&lt;/span&gt;
&lt;span class="go"&gt; default-lease-time 600;&lt;/span&gt;
&lt;span class="go"&gt; option subnet-mask 255.255.255.0;&lt;/span&gt;
&lt;span class="go"&gt; option broadcast-address 192.168.100.255;&lt;/span&gt;
&lt;span class="go"&gt; option routers 192.168.100.1;&lt;/span&gt;
&lt;span class="go"&gt; option domain-name-servers 192.168.1.1;&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;

&lt;span class="go"&gt;host clinux {&lt;/span&gt;
&lt;span class="go"&gt;hardware ethernet 52:54:00:20:cb:8f;&lt;/span&gt;
&lt;span class="go"&gt;fixed-address 192.168.100.100;&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;

&lt;span class="go"&gt;subnet 192.168.200.0 netmask 255.255.255.0 {&lt;/span&gt;
&lt;span class="go"&gt; range 192.168.200.2 192.168.200.254;&lt;/span&gt;
&lt;span class="go"&gt; max-lease-time 43200;&lt;/span&gt;
&lt;span class="go"&gt; default-lease-time 600;&lt;/span&gt;
&lt;span class="go"&gt; option subnet-mask 255.255.255.0;&lt;/span&gt;
&lt;span class="go"&gt; option broadcast-address 192.168.200.255;&lt;/span&gt;
&lt;span class="go"&gt; option routers 192.168.200.1;&lt;/span&gt;
&lt;span class="go"&gt; option domain-name-servers 192.168.1.1;&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reinicia el servicio con:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;systemctl restart isc-server-dhcp&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Agregar la ruta a IPTABLES para la nueva red:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo iptables -t nat -A POSTROUTING -s 192.168.200.0/24 -o ens6 -j MASQUERADE&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;En el nuevo cliente "clinux2" cambiar el fichero &lt;code&gt;/etc/network/interfaces&lt;/code&gt;, quedando así&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;auto ens6&lt;/span&gt;
&lt;span class="go"&gt;iface ens6 inet dhcp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Reinicia el servicio "networking" en el cliente:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl restart networking&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A continuación se muestran unas capturas de ambos clientes saliendo a internet:&lt;/p&gt;
&lt;p&gt;&lt;img alt="traceroute2clinux" src="https://arpovea.vercel.app/images/DHCP/traceroute2clinux.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="traceroute2clinux2" src="https://arpovea.vercel.app/images/DHCP/traceroute2clinux2.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.    &lt;/p&gt;</content><category term="Servicios"></category></entry><entry><title>RCLONE</title><link href="https://arpovea.vercel.app/rclone.html" rel="alternate"></link><published>2020-09-29T00:00:00+02:00</published><updated>2020-09-29T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-09-29:/rclone.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a utilizar la herramienta Rclone, como instalar, como configurar varios almacenamientos de la nube y distintas funcionalidades.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a utilizar la herramienta Rclone, como instalar, como configurar varios almacenamientos de la nube y distintas funcionalidades.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;RClone&lt;/h2&gt;
&lt;p&gt;Rclone es una herramienta que permite trabajar con los ficheros que esten almacenados en los distintos servicios de almacenamiento en la nube, puede gestionar y sincronizar los ficheros de los servicios desde la linea de comandos.&lt;/p&gt;
&lt;h3&gt;Instalación de Rclone&lt;/h3&gt;
&lt;p&gt;Esta herramienta esta disponible en los repositorios oficiales de Debian Buster, ya que se esta usando esa distribución en este ejemplo, para instalar esta herramienta se realiza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt install rclone
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configuración de los proveedores cloud&lt;/h3&gt;
&lt;p&gt;Se va a configurar dos proveedores cloud, cada proveedor utiliza distintas formas de hacerlo.&lt;/p&gt;
&lt;h4&gt;Configuración Dropbox&lt;/h4&gt;
&lt;p&gt;Desde el terminal ejecuta:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone config
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Y elije la opción:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;n) New remote&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación hay que facilitar los siguientes datos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Un nombre con el que se va a identificar este proveedor. (En este caso dropbox)&lt;/li&gt;
&lt;li&gt;De la lista de proveedores elejir el que nos interesa. (Numero 8, que es Dropbox)&lt;/li&gt;
&lt;li&gt;Usuario y contraseña si se utiliza una API (En este caso se deja por defecto,es decir, haz un INTRO)&lt;/li&gt;
&lt;li&gt;Configuración avanzada. (En este caso se selecciona "No")&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;En el terminal se vería así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;dropbox&lt;/span&gt;
&lt;span class="k"&gt;Type&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="k"&gt;storage&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Press&lt;/span&gt; &lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;
&lt;span class="n"&gt;Choose&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="nb"&gt;number&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;own&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
 &lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Dropbox&lt;/span&gt;
   &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;dropbox&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="k"&gt;Storage&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;
&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="n"&gt;See&lt;/span&gt; &lt;span class="n"&gt;help&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dropbox&lt;/span&gt; &lt;span class="n"&gt;backend&lt;/span&gt; &lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;rclone&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dropbox&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;

&lt;span class="n"&gt;Dropbox&lt;/span&gt; &lt;span class="n"&gt;App&lt;/span&gt; &lt;span class="n"&gt;Client&lt;/span&gt; &lt;span class="n"&gt;Id&lt;/span&gt;
&lt;span class="n"&gt;Leave&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt; &lt;span class="n"&gt;normally&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Press&lt;/span&gt; &lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;
&lt;span class="n"&gt;client_id&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; 
&lt;span class="n"&gt;Dropbox&lt;/span&gt; &lt;span class="n"&gt;App&lt;/span&gt; &lt;span class="n"&gt;Client&lt;/span&gt; &lt;span class="n"&gt;Secret&lt;/span&gt;
&lt;span class="n"&gt;Leave&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt; &lt;span class="n"&gt;normally&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Press&lt;/span&gt; &lt;span class="n"&gt;Enter&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;
&lt;span class="n"&gt;client_secret&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; 
&lt;span class="n"&gt;Edit&lt;/span&gt; &lt;span class="n"&gt;advanced&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Yes&lt;/span&gt;
&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;No&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;
&lt;span class="n"&gt;Remote&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;
&lt;span class="n"&gt;Use&lt;/span&gt; &lt;span class="n"&gt;auto&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;
 &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Say&lt;/span&gt; &lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;sure&lt;/span&gt;
 &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;Say&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="k"&gt;are&lt;/span&gt; &lt;span class="n"&gt;working&lt;/span&gt; &lt;span class="k"&gt;on&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="n"&gt;headless&lt;/span&gt; &lt;span class="n"&gt;machine&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Yes&lt;/span&gt;
&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;No&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Aqui hay dos opciones:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Si estas trabajando en local con entorno gráfico: Elige &lt;code&gt;y) Yes&lt;/code&gt;, esto provocará que se abra un navegador donde introducir la cuenta de dropbox que queremos asignar y dando permiso a rclone.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Si estas trabajando en remoto o sin entorno gráfico: Elige &lt;code&gt;n) No&lt;/code&gt;, esto pedirá que ejecutes en otra máquina que tenga entorno el comando:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone authorize &lt;span class="s2"&gt;&amp;quot;dropbox&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esto provocará que salte un navegador donde se indicará la cuenta y que se autoriza a rclone como en la anterior opción con la diferencia de que una vez se haya autorizado hay que copiar un código que aparece en la terminal y pegarlo en la terminal de la máquina en la que estas trabajando con rclone. En la terminal:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;For&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;work&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;will&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;need&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rclone&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;machine&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;has&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;Execute&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;following&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;machine&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rclone&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;authorize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;dropbox&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;Then&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;paste&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;result&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;below&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;result&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;access_token&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;f8wc24NV1XwAAAAAAAAAAeXRdjQ5u8pm5V7QBvec0OqzJjPkveFWN6UTGR8PDugG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;token_type&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;bearer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;expiry&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;0001-01-01T00:00:00Z&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;--------------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dropbox&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;access_token&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;f8wc24NV1XwAAAAAAAAAAeXRdjQ5u8pm5V7QBvec0OqzJjPkveFWN6UTGR8PDugG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;token_type&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;bearer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;expiry&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;0001-01-01T00:00:00Z&amp;quot;&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;--------------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Yes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OK&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Delete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;Current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;remotes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="n"&gt;Type&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;====&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="o"&gt;====&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;dropbox&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="n"&gt;dropbox&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Al finalizar como se puede ver lista los proveedores configurados.&lt;/p&gt;
&lt;h3&gt;Configuración Google Drive&lt;/h3&gt;
&lt;p&gt;Básicamente es muy parecida a la de dropbox, se comentarán los cambios:&lt;/p&gt;
&lt;p&gt;De nuevo escribe el siguiente comando para iniciar la configuración:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone config
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Variaciones respecto a la configuración de Dropbox, aparte de que la elección en este caso será la (12):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Choose&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;own&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
 &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Full&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;excluding&lt;/span&gt; &lt;span class="n"&gt;Application&lt;/span&gt; &lt;span class="n"&gt;Data&lt;/span&gt; &lt;span class="n"&gt;Folder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   \ &lt;span class="s2"&gt;&amp;quot;drive&amp;quot;&lt;/span&gt;
 &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Read&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;metadata&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;contents&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   \ &lt;span class="s2"&gt;&amp;quot;drive.readonly&amp;quot;&lt;/span&gt;
   &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;rclone&lt;/span&gt; &lt;span class="n"&gt;only&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
 &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;These&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;visible&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;drive&lt;/span&gt; &lt;span class="n"&gt;website&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="n"&gt;authorization&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;revoked&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="n"&gt;deauthorizes&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   \ &lt;span class="s2"&gt;&amp;quot;drive.file&amp;quot;&lt;/span&gt;
   &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Allows&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;write&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;Application&lt;/span&gt; &lt;span class="n"&gt;Data&lt;/span&gt; &lt;span class="n"&gt;folder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
 &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;visible&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;drive&lt;/span&gt; &lt;span class="n"&gt;website&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   \ &lt;span class="s2"&gt;&amp;quot;drive.appfolder&amp;quot;&lt;/span&gt;
   &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;Allows&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;metadata&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt;
 &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;does&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;allow&lt;/span&gt; &lt;span class="n"&gt;any&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;download&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
   \ &lt;span class="s2"&gt;&amp;quot;drive.metadata.readonly&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;scope&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Aquí básicamente pide los permisos que se le van a conceder a rclone las opciones son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Acceso completo excluyendo la carpeta de datos de aplicaciones.&lt;/li&gt;
&lt;li&gt;Acceso de solo lectura&lt;/li&gt;
&lt;li&gt;Acceso solo a los ficheros creados con Rclone&lt;/li&gt;
&lt;li&gt;Acceso completo incluyendo la carpeta de datos de aplicaciones.&lt;/li&gt;
&lt;li&gt;Acceso de solo lectura a los archivos metadata.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Luego preguntará por ID de root y un fichero de Json para el servicio de credenciales de la cuenta lo cual no hace falta, pulsa "INTRO" en terminal:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;ID of the root folder&lt;/span&gt;
&lt;span class="err"&gt;Leave blank normally.&lt;/span&gt;
&lt;span class="err"&gt;Fill in to access &amp;quot;Computers&amp;quot; folders. (see docs).&lt;/span&gt;
&lt;span class="err"&gt;Enter a string value. Press Enter for the default (&amp;quot;&amp;quot;).&lt;/span&gt;
&lt;span class="err"&gt;root_folder_id&amp;gt; &lt;/span&gt;
&lt;span class="err"&gt;Service Account Credentials JSON file path &lt;/span&gt;
&lt;span class="err"&gt;Leave blank normally.&lt;/span&gt;
&lt;span class="err"&gt;Needed only if you want use SA instead of interactive login.&lt;/span&gt;
&lt;span class="err"&gt;Enter a string value. Press Enter for the default (&amp;quot;&amp;quot;).&lt;/span&gt;
&lt;span class="err"&gt;service_account_file&amp;gt; &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Continuando pedirá las mismas opciones ya explicadas en el apartado de Dropbox finalizando sin problemas.&lt;/p&gt;
&lt;h3&gt;Opciones de Rclone&lt;/h3&gt;
&lt;p&gt;A continuación se verán las opciones mas usadas y útiles:&lt;/p&gt;
&lt;p&gt;Para listar los directorios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone lsd remote-dir-name:
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para listar los ficheros:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone ls remote-dir-name:
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para copiar de origen a destino:(Puede ser entre dos proveedores de nube o entre un proveedor y una carpeta local).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone copy source:sourcepath dest:destpath
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para sincronizar datos entre origen y destino:(Como en el anterior puede ser entre proveedores o entre proveedor y carpeta local).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone sync source:path dest:path &lt;span class="o"&gt;[&lt;/span&gt;flags&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;En este cado la fuente(origen) sincroniza con el destino, cambiando solo lo que hay en destino, este método salta ficheros sin cambios, este comando puede causar la pérdida de datos por lo que es aconsejable usarlo con el [flag] "--dry-run" para ver que se copiará y eliminará.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para mover datos sería así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone move source:path dest:path &lt;span class="o"&gt;[&lt;/span&gt;flags&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para crear un directorio:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone mkdir remote:path
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para borrar un directorio vacío:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone rmdir remote:path
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para borrar un directorio con contenido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone purge remote:path
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para comprobar si los archivos entre origen y destino coinciden:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone check source:path dest:path
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para borrar ficheros:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone delete remote:path
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Cada uno de los comandos rclone se pueden usar con diferentes [flags] e incluyen su propio menú de ayuda. Por ejemplo, puede hacer una eliminación selectiva utilizando la opción de eliminar que elimina archivos mayores de 100M , el comando sería así:    &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone --min-size 100M delete remote:path
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Montar proveedor en una carpeta local y sincronizados.&lt;/h3&gt;
&lt;p&gt;Otra utilidad es la de montar las unidades del proveedor como unidad local. La información seguirá estando en la nube pero podemos trabajar con ella como si estuviera en local:&lt;/p&gt;
&lt;p&gt;Para esto hay que tener instalado el paquete "fuse" en la máquina local y tener agregado ya un servicio como se ha visto en pasos anteriores, en este caso se utilizará Google Drive:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install fuse
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Crear un directorio local:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir Gdrive
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Montar el proveedor en la carpeta que se ha creado:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rclone mount --vfs-cache-mode writes Gdrive: Gdrive &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez montado se podrá editar, crear y eliminar de forma local, y esto se sincronizará con la nube automáticamente.  &lt;br&gt;
A continuación se muestran unas capturas del montaje y borrado de un fichero en la terminal y como se borra en el proveedor, en este caso Google Drive.&lt;/p&gt;
&lt;p&gt;&lt;img alt="MontajeyBorradoTerminal" src="https://arpovea.vercel.app/images/Rclone/comandosmount.png"&gt; &lt;/p&gt;
&lt;p&gt;&lt;img alt="BorradoGoogleDrive" src="https://arpovea.vercel.app/images/Rclone/pruebaborrado.png"&gt;   &lt;/p&gt;
&lt;p&gt;Para desmontar utiliza fusermount con la opción -u sobre la carpeta:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;fusermount -u Gdrive
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Hay muchos mas comandos y utilidades si quieres saber mas consulta la documentación oficial &lt;a href="https://rclone.org/"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.&lt;/p&gt;</content><category term="Seguridad"></category></entry><entry><title>Tareas con RAID5</title><link href="https://arpovea.vercel.app/tareas-con-raid5.html" rel="alternate"></link><published>2020-09-28T00:00:00+02:00</published><updated>2020-09-28T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-09-28:/tareas-con-raid5.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión vamos a realizar un RAID5 y vamos a realizar varias pruebas. Utilizaremos RAID software en Linux con &lt;code&gt;mdadm&lt;/code&gt;.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión vamos a realizar un RAID5 y vamos a realizar varias pruebas. Utilizaremos RAID software en Linux con &lt;code&gt;mdadm&lt;/code&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Preparación para la tarea sobre RAID5&lt;/h2&gt;
&lt;p&gt;Para realizar esta tarea se va a utilizar una máquina virtual con vagrant-libvirt la configuración de vagrantfile es la siguiente:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# -*- mode: ruby -*-&lt;/span&gt;
&lt;span class="c1"&gt;# vi: set ft=ruby :&lt;/span&gt;

&lt;span class="no"&gt;Vagrant&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;provider&lt;/span&gt; &lt;span class="ss"&gt;:libvirt&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt; &lt;span class="ss"&gt;:file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:size&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1G&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt; &lt;span class="ss"&gt;:file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:size&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1G&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt; &lt;span class="ss"&gt;:file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:size&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1G&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt; &lt;span class="ss"&gt;:file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:size&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1G&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;libvirt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt; &lt;span class="ss"&gt;:file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:size&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1G&amp;#39;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;debian/buster64&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como podemos observar en el fichero agregamos 5 discos para realizar distintas pruebas a lo largo del ejercicio.&lt;/p&gt;
&lt;p&gt;Una vez iniciada la máquina deberías obtener con el comando &lt;code&gt;lsblk&lt;/code&gt; lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img alt="lsblk" src="https://arpovea.vercel.app/images/TareaRAID5/lsblk.png"&gt;  &lt;/p&gt;
&lt;p&gt;Lo siguiente es instalar el paquete &lt;code&gt;mdadm&lt;/code&gt;, si no lo tenéis ya instalado en la máquina virtual:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt install -y mdadm
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;Tareas RAID5&lt;/h2&gt;
&lt;h4&gt;Tarea 1: Crea una raid llamado "md5" con los discos que hemos conectado a la máquina. ¿Cuántos discos tienes que conectar? ¿Qué diferencia existe entre el RAID 5 y el RAID1?.&lt;/h4&gt;
&lt;p&gt;Para el RAID5 hay que conectar 3 discos, es decir tiene en total una capacidad de 2GB, para hacer esto utiliza el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm -C /dev/md5 --level&lt;span class="o"&gt;=&lt;/span&gt;RAID5 --raid-devices&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt; /dev/vdb /dev/vdc /dev/vdd
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Si realizas de nuevo un &lt;code&gt;lsblk&lt;/code&gt; obtendrás algo como esto:&lt;/p&gt;
&lt;p&gt;&lt;img alt="lsblk2" src="https://arpovea.vercel.app/images/TareaRAID5/lsblk2.png"&gt;&lt;/p&gt;
&lt;p&gt;La diferencia entre RAID5 y RAID1 es:&lt;/p&gt;
&lt;p&gt;En RAID5 los bloques estan distribuidos entre los 3 discos(los mínimos en RAID5) y soporta la pérdida total de unos de ellos, ya que distribuye la paridad entre los 3 dispositivos, pudiendo con dos recuperar toda la información.&lt;/p&gt;
&lt;p&gt;En RAID1 se utilizan dos discos y uno es una copia exacta del otro, tiene ventajas en velocidades de lectura, ya que se puede leer de los dos discos, pero tiene desventaja en la escritura ya debe escribir en ambos discos la misma información.&lt;/p&gt;
&lt;h4&gt;Tarea 2: Comprueba las características del RAID. Comprueba el estado del RAID. ¿Qué capacidad tiene el RAID que hemos creado?.&lt;/h4&gt;
&lt;p&gt;La capacidad es de 2GB, para comprobar el estado del RAID5 se consulta un fichero y para los detalles un comando: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Consultando el fichero &lt;code&gt;/etc/proc/mdstat&lt;/code&gt; para ver su estado:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo cat /proc/mdstat
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Consultando los detalles:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm -D /dev/md5
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En la siguiente imagen se pueden ver tanto el estado como los detalles:&lt;/p&gt;
&lt;p&gt;&lt;img alt="mdadmstatus" src="https://arpovea.vercel.app/images/TareaRAID5/comprobacionstadoraid.png"&gt;&lt;/p&gt;
&lt;h4&gt;Tarea 3: Crea un volumen lógico (LVM) de 500MB en el RAID5.&lt;/h4&gt;
&lt;p&gt;Para esto hay que añadir el RAID5 a los volúmenes físicos, crear un grupo de volúmenes que utilize ese dispositivo y luego crear el volumen lógico:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo pvcreate /dev/md5
sudo vgcreate tareas /dev/md5
sudo lvcreate tareas -L 500M -n tarea3
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Quedando como en la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Vlogico" src="https://arpovea.vercel.app/images/TareaRAID5/Vlogico.png"&gt;&lt;/p&gt;
&lt;h4&gt;Tarea 4: Formatea ese volumen con un sistema de archivo &lt;code&gt;xfs&lt;/code&gt;.&lt;/h4&gt;
&lt;p&gt;Realiza el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mkfs.xfs /dev/tareas/tarea3
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Tarea 5: Monta el volumen en el directorio &lt;code&gt;/mnt/RAID5&lt;/code&gt; y crea un fichero. ¿Qué tendríamos que hacer para que este punto de montaje sea permanente?.&lt;/h4&gt;
&lt;p&gt;Para ello:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mkdir /mnt/RAID5
sudo mount -t xfs /dev/tareas/tarea3 /mnt/RAID5
touch /mnt/RAID5/fich.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para que fuera permanente tendrías que incluir este montaje en el fichero &lt;code&gt;fstab&lt;/code&gt;.    &lt;/p&gt;
&lt;h4&gt;Tarea 6: Marca un disco como estropeado. Muestra el estado del raid para comprobar que un disco falla. ¿Podemos acceder al fichero?.&lt;/h4&gt;
&lt;p&gt;Para marcar un disco, por ejemplo &lt;code&gt;vdb&lt;/code&gt; como fallido utiliza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --manage /dev/md5 --fail /dev/vdb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Luego mira el estado con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat /proc/mdstat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Mostrará algo similar a la siguiente imagen donde se observa que el disco esta marcado como fallido:&lt;/p&gt;
&lt;p&gt;&lt;img alt="fallovdb" src="https://arpovea.vercel.app/images/TareaRAID5/fallovdb.png"&gt;&lt;/p&gt;
&lt;p&gt;El fichero se puede seguir visualizando sin problema.&lt;/p&gt;
&lt;h4&gt;Tarea 7: Una vez marcado como estropeado, lo tenemos que retirar del raid.&lt;/h4&gt;
&lt;p&gt;Para ello utiliza el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --manage /dev/md5 --remove /dev/vdb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Observamos de nuevo el estado del RAID5 y mostrará lo siguiente:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat /etc/proc/mdstat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="removevdb" src="https://arpovea.vercel.app/images/TareaRAID5/removevdb.png"&gt;&lt;/p&gt;
&lt;h4&gt;Tarea 8: Imaginemos que lo cambiamos por un nuevo disco nuevo (el dispositivo de bloque se llama igual), añádelo al array y&lt;/h4&gt;
&lt;p&gt;comprueba como se sincroniza con el anterior. &lt;/p&gt;
&lt;p&gt;Para ello en este caso con un nuevo disco "vde":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --manage /dev/md5 --add /dev/vde
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Automáticamente se sincroniza con el raid, observa los cambios con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lsblk
cat /proc/mdstat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Obteniendo algo similar a lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img alt="agregandovde" src="https://arpovea.vercel.app/images/TareaRAID5/agregandovde.png"&gt;&lt;/p&gt;
&lt;h4&gt;Tarea 9: Añade otro disco como reserva. Vuelve a simular el fallo de un disco y comprueba como automáticamente se realiza la sincronización con el disco de reserva.&lt;/h4&gt;
&lt;p&gt;Realiza los siguiente comandos para añadir el disco como reserva:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mdadm --manage /dev/md5 -add /dev/vdf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Puedes comprobar que se ha añadido como "SPARE" comprobando el estado o los detalles del RAID5 con los siguientes comandos:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm -D /dev/md5
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;O&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat /proc/mdstat
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ahora vuelve a marcar otro dispositivo como fallido esta vez &lt;code&gt;vdc&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --manage /dev/md5 --fail /dev/vdc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como podemos ver en la siguiente imagen el disco pasa de SPARE (S) a activo y el otro se marca como FAIL (F)&lt;/p&gt;
&lt;p&gt;&lt;img alt="SPAREautilizado" src="https://arpovea.vercel.app/images/TareaRAID5/SPAREautilizado.png"&gt;&lt;/p&gt;
&lt;p&gt;Como repunte, si quisieras que el disco se agrege como dispositivo adicional para aumentar las dimesiones del raid, después de agregarlo, realiza el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --grow /dev/md5 --raid-devices&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Y luego aumentar el raid a la máxima capacidad disponible con:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mdadm --grow /dev/md5 -z max
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;Tarea 10: Redimensiona el volumen y el sistema de archivo de 500MB al tamaño del raid.&lt;/h4&gt;
&lt;p&gt;Con los siguientes comandos podras redimensionar el volumen y luego redimensionar el sistema de ficheros:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo lvextend -L +1.5G /dev/tareas/tarea3 
sudo xfs_growfs /mnt/RAID5/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Recalcar que con &lt;code&gt;xfs&lt;/code&gt;se puede realizar esta acción en caliente con otros sistemas de ficheros podría ocasionar errores o pérdida de datos.&lt;/p&gt;
&lt;p&gt;Al finalizar todas las tareas en este orden la orden &lt;code&gt;lsblk -f&lt;/code&gt; debería mostrar algo así:&lt;/p&gt;
&lt;p&gt;&lt;img alt="lsblkfinal" src="https://arpovea.vercel.app/images/TareaRAID5/lsblkfinal.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.    &lt;/p&gt;</content><category term="Seguridad"></category></entry><entry><title>Instalación Debian Buster con LVM</title><link href="https://arpovea.vercel.app/instalacion-debian-buster-con-lvm.html" rel="alternate"></link><published>2020-09-26T00:00:00+02:00</published><updated>2020-09-26T00:00:00+02:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-09-26:/instalacion-debian-buster-con-lvm.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión vamos a instalar el sistema operativo Debian Buster con particiones LVM, y vamos a exponer los errores producidos y las soluciones que hemos realizado.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión vamos a instalar el sistema operativo Debian Buster con particiones LVM, y vamos a exponer los errores producidos y las soluciones que hemos realizado.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Esquema de particiones realizado en la instalación:&lt;/h2&gt;
&lt;p&gt;En este caso se tiene un  SSD de 250 GB con una instalación de windows que ocupa algo mas de 100 GB, al final disponen de unos 140 GB para la instalación del sistema Debian Buster.&lt;/p&gt;
&lt;p&gt;Una vez se llega a la parte de particionado de la instalación del sistema Debian Buster:&lt;/p&gt;
&lt;p&gt;Se va a crear una partición de 500MB para &lt;code&gt;/boot&lt;/code&gt; aparte del sistema LVM ya que esto no interesa que cambie en un futuro, una vez realizado esto selecciona "Configurar el Gestor de Volúmenes Lógicos (LVM)" en el cual pedirá:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Crear un grupo de volumenes y seleccionar el disco que se va a utilizar:   &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;En este caso se le llama al grupo de volumenes "Sistema" y se elige el espacio libre para que lo utilize como si fuera un disco físico, en total unos 140 GB como se ha mencionado anteriormente.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Luego hay que crear los volúmenes lógicos dentro de ese grupo de volúmenes:   &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para ellos selecciona el grupo de volúmenes de "Sistema" y crea dos volúmenes lógicos, a uno se le llama "root" donde se montará el raiz y al otro "home" donde se montará /home. El sistema de fichero utilizados en estos dos volumenes es "xfs".&lt;/p&gt;
&lt;p&gt;Una vez realizado esto procedemos con la instalación normalmente hasta finalizarla.&lt;/p&gt;
&lt;p&gt;Una vez iniciado el sistema, con los siguientes comandos se comprueba que todo a quedado como se pretendia:&lt;/p&gt;
&lt;p&gt;Listamos dispositivos de bloque del sistema:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lsblk
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="lsblk" src="https://arpovea.vercel.app/images/Insta.S.O/lsblk.png"&gt;  &lt;/p&gt;
&lt;p&gt;Listamos los dispositivos físicos agregados a LVM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo pvdisplay
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="pvdisplay" src="https://arpovea.vercel.app/images/Insta.S.O/pvdisplay.png"&gt;&lt;/p&gt;
&lt;p&gt;Listamos los volúmenes lógicos:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo lvdisplay
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="lvdisplay" src="https://arpovea.vercel.app/images/Insta.S.O/lvdisplay.png"&gt;&lt;/p&gt;
&lt;p&gt;Listamos los grupos de vólumenes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo vgs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="vgs" src="https://arpovea.vercel.app/images/Insta.S.O/vgs.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Solución de errores:&lt;/h2&gt;
&lt;p&gt;Errores producidos dependiendo del modelo de nuestros dispositivos, en este caso se esta utilizanddo un portatil MSI &lt;a href="https://es.msi.com/Laptop/GS73-7RE-Stealth-Pro/Specification"&gt;GS73 7RE Stealth Pro&lt;/a&gt;:&lt;/p&gt;
&lt;h3&gt;1. El equipo se queda congelado en el arranque:&lt;/h3&gt;
&lt;p&gt;En este caso concreto lo que provocaba la congelación era problema de la gráfica nvidia.   &lt;/p&gt;
&lt;p&gt;Procede a iniciar el equipo con la opción &lt;code&gt;nouveau.modeset=0&lt;/code&gt; esto obliga el kernel a no cargar el controlador libre de nvidia que es nouveau lo cual elimina el congelamiento ya que aún no están instalados los drives nvidia. &lt;/p&gt;
&lt;p&gt;Para realizar esto una vez arranque grub pulsamos la tecla "e" lo cual permitirá editar las opciones de arranque por defecto y no se realiza de forma permanente, hay que escribir esta opción al final de la línea que comienza por "linux", para iniciar con estas opciones que se han editado pulsar la tecla "F10".    &lt;/p&gt;
&lt;p&gt;Una vez se puede acceder a una TTY lo primero a realizar es activar los repositorios &lt;code&gt;non-free&lt;/code&gt; para poder instalar los controladores necesarios para la tarjeta gráfica para ello edita los repositorios:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo nano /etc/apt/source.list 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Y agrega al final del repositorio deseado &lt;code&gt;contrib non-free&lt;/code&gt;, ejemplo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;deb http://deb.debian.org/debian buster main contrib non-free
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Luego actualizamos la lista de paquetes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt update
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Instala nvidia-detect, para detectar el paquete que utiliza tu gráfica y instala dicho paquete:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install nvidia-detect
sudo nvidia-detect
sudo apt install nvidia-driver
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto reinicia el equipo si todo va bien debería de funcionar, en nuestro caso esto no funciono, ya que la tarjeta gráfica tenía varios bugs tanto en la versión del Kernel que estaba utilizando la versión de Buster instalada como en la versión del paquete "nvidia-driver".    &lt;/p&gt;
&lt;p&gt;Si todo ha fallado realiza la desistalación completa del driver de nvidia, de nuevo en una TTY:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt purge nvidia*
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ahora se va a utilizar los backport para instalar tanto el kernel como el paquete mas actual disponible. Para ello agrega una nueva linea al &lt;code&gt;source.list&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;deb http://deb.debian.org/debian buster-backports main contrib non-free
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Realiza un update, comprueba versiones, y instala dichas versiones:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt update
sudo apt policy linux-image-amd64
sudo apt policy nvidia-driver
sudo apt install -t buster-backports linux-image-amd64 nvidia-driver
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez reiniciado esto soluciono el tema gráfico del equipo.&lt;/p&gt;
&lt;h3&gt;2. La tarjeta wifi no funciona:&lt;/h3&gt;
&lt;p&gt;Esto suele ocurrir sobre todo con las tarjetas Realtek y las Atheros, simplemente instalando el firmware/driver de la tarjeta del equipo se soluciona, en este caso:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt install firmware-atheros
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;3. Problema con bluetooth y Thunderbolt&lt;/h3&gt;
&lt;p&gt;Al iniciar el equipo todo funciona correctamente, pero si realizamos una comprobación de los logs con &lt;code&gt;journalctl&lt;/code&gt; en este equipo en concreto se observan errores con algunos componentes, como son el bluetooth y Thunderbolt, en principio como son dos dispositivos que no se van a utilizar vamos a desactivar el módulo del Kernel de ambos que da problemas, para ello se crea un fichero en &lt;code&gt;/etc/modprobe.d/blacklist.conf&lt;/code&gt; con el siguiente contenido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;blacklist btusb&lt;/span&gt;
&lt;span class="err"&gt;blacklist bluetooth&lt;/span&gt;
&lt;span class="err"&gt;blacklist thunderbolt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con esto no se cargaran estos módulos del kernel al iniciar, evitando dichos errores.&lt;/p&gt;
&lt;h3&gt;4. Distintos problemas que aparecen en los logs&lt;/h3&gt;
&lt;p&gt;Uno de los errores que se repetían en los logs de este equipo era con los puertos PCIe del tipo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;pcieport 0000:00:03.0: PCIe Bus Error: AER / Bad TLP&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Buscando bastante información, encontre que la CPU se comunica con los controladores de bus PCIe mediante unos paquetes (TLP), el hardware detecta cuando hay fallos y el kernel de linux informa de estos errores, con la opción &lt;code&gt;pci=nommconf&lt;/code&gt; deshabilitas una configuración de los PCI llamada &lt;code&gt;Memory-Mapped PCI&lt;/code&gt; que esta implementada en el Kernel linux desde el 2.6, antes de esto, todos los dispositivos PCI tenían un área que describía a este dispositivo, y el método original para acceder a este área era con I/O, mientras que con el nuevo "método" se simplifica este mecanismo para que sea mas eficiente, pues deshabilitando este nuevo "método" y volviendo al original, soluciona este problema.&lt;/p&gt;
&lt;p&gt;Esto es un caso particular, por los distintos componentes y su unión, pero utilizando esta opción del Kernel se soluciona el problema.&lt;/p&gt;
&lt;p&gt;Para que esta opción sea definitiva vamos a editar una línea en el fichero &lt;code&gt;/etc/default/grup&lt;/code&gt; quedando por ejemplo así:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;GRUB_CMDLINE_LINUX_DEFAULT=&amp;quot;pci=nommconf&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez guardado realiza:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo update-grub
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Y una vez se reinicie la máquina el Kernel arrancará con esta opción.&lt;/p&gt;
&lt;p&gt;Otras opciones interesantes para corregir los errores en los logs del sistema con los PCI/PCIe son las opción &lt;code&gt;pci=noaer&lt;/code&gt; y &lt;code&gt;pci=nomsi&lt;/code&gt; pero ya dependerá de vuestro caso, podéis consultar la siguiente página para comprobar o buscar parámetros del Kernel &lt;a href="https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.html"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.&lt;/p&gt;</content><category term="Sistemas"></category></entry><entry><title>Creacion de usuarios BATCH</title><link href="https://arpovea.vercel.app/creacion-de-usuarios-batch.html" rel="alternate"></link><published>2020-02-19T00:00:00+01:00</published><updated>2020-02-19T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-02-19:/creacion-de-usuarios-batch.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se van crear usuarios con los comandos &lt;code&gt;newusers&lt;/code&gt;,&lt;code&gt;chpasswd&lt;/code&gt;,&lt;code&gt;pwgen&lt;/code&gt; y la sentencia de iteración &lt;code&gt;for&lt;/code&gt;.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se van crear usuarios con los comandos &lt;code&gt;newusers&lt;/code&gt;,&lt;code&gt;chpasswd&lt;/code&gt;,&lt;code&gt;pwgen&lt;/code&gt; y la sentencia de iteración &lt;code&gt;for&lt;/code&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Desarrollo&lt;/h2&gt;
&lt;p&gt;Se crea el fichero con el formato que acepta el comando &lt;code&gt;newusers&lt;/code&gt; que es el mismo que el del fichero /etc/passwd.    &lt;/p&gt;
&lt;p&gt;Para ello se utiliza la sentencia &lt;code&gt;for&lt;/code&gt;:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; i in &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;..9&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; usuario&lt;span class="nv"&gt;$i&lt;/span&gt;:x:110&lt;span class="nv"&gt;$i&lt;/span&gt;:110&lt;span class="nv"&gt;$i&lt;/span&gt;:&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;usuario&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;:/home/usuario&lt;span class="nv"&gt;$i&lt;/span&gt;:/bin/bash &amp;gt;&amp;gt;
usuarios
&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Visualización del fichero usuarios:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="usuarios" src="https://arpovea.vercel.app/images/BATCH/usuarios.png"&gt;    &lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/arpovea/arpovea.github.io/blob/master/assets/img/BATCH/usuarios"&gt;Link fichero usuarios&lt;/a&gt;    &lt;/p&gt;
&lt;p&gt;Una vez generado ese fichero se va a crear otro con los nombre de usuarios y las contraseñas el cual se genera con &lt;code&gt;pwgen&lt;/code&gt; y la sentencia &lt;code&gt;for&lt;/code&gt;:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; i in &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;..9&lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; usuario&lt;span class="nv"&gt;$i&lt;/span&gt;:&lt;span class="sb"&gt;`&lt;/span&gt;pwgen -s &lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt; &amp;gt;&amp;gt; contraseñas
&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Visualización del fichero contraseñas:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="contraseñas" src="https://arpovea.vercel.app/images/BATCH/contraseñas.png"&gt;    &lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/arpovea/arpovea.github.io/blob/master/assets/img/BATCH/contraseñas"&gt;Link fichero contraseñas&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Una vez generado estos ficheros solo queda pasarselos a los comandos para crear los usuarios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo newusers &amp;lt; usuarios
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se añaden las contraseñas:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chpasswd &amp;lt; contraseñas
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Y con esto tendriamos creados los usuarios.    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.    &lt;/p&gt;</content><category term="Sistemas"></category></entry><entry><title>UGO-Permisos y propietarios</title><link href="https://arpovea.vercel.app/ugo-permisos-y-propietarios.html" rel="alternate"></link><published>2020-02-19T00:00:00+01:00</published><updated>2020-02-19T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-02-19:/ugo-permisos-y-propietarios.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a a realizar una actividad de usuarios y permisos del curso 1º ASIR de la asignatura: Implantacion de Sistemas Operativos.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a a realizar una actividad de usuarios y permisos del curso 1º ASIR de la asignatura: Implantacion de Sistemas Operativos.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Enunciado Ejercicio:&lt;/h2&gt;
&lt;p&gt;Crea los siguientes grupos de usuarios: sistemas, desarrollo y explotación.    &lt;/p&gt;
&lt;p&gt;Crea dentro del directorio raíz, el directorio proyecto, con permisos de propietario: root, y grupo del propietario:root.    &lt;/p&gt;
&lt;p&gt;Dentro del directorio proyecto, crearás los directorios: sistemas, desarrollo y explotación.    &lt;/p&gt;
&lt;p&gt;Estos directorios serán propiedad de root, y como grupo de propietario los grupos sistemas, desarrollo y explotación respectivamente, creados anteriormente. Y tendrán permisos de lectura, escritura  y ejecución para propietario y grupo de propietario. El grupo otros no tendrá ningún permiso.&lt;/p&gt;
&lt;p&gt;Crea los siguientes usuarios:    &lt;/p&gt;
&lt;p&gt;grupo: sistemas. Usuarios del grupo sistemas: sistemas1 y sistemas2.    &lt;/p&gt;
&lt;p&gt;grupo: desarrollo. Usuarios del grupo desarrollo: desarrollo1 y desarrollo2.    &lt;/p&gt;
&lt;p&gt;grupo: explotación. Usuarios del grupo explotación: explotacion1 y explotacion2.    &lt;/p&gt;
&lt;p&gt;Los directorios de trabajo de dichos usuarios serán los directorios creados anteriormente, sistemas, desarrollo y explotación.    &lt;/p&gt;
&lt;p&gt;Los usuarios de sistemas tendrán acceso de lectura, escritura y ejecución al directorio sistemas, desarrollo y explotación.    &lt;/p&gt;
&lt;p&gt;Los usuarios de desarrollo tendrán acceso de lectura, escritura y ejecución al directorio desarrollo y explotación.    &lt;/p&gt;
&lt;p&gt;Los usuarios de explotación tendrán acceso de lectura, escritura y ejecución al directorio explotación únicamente.    &lt;/p&gt;
&lt;h2&gt;Desarollo del ejercicio:&lt;/h2&gt;
&lt;p&gt;Creación de los directorios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mkdir -p /raiz/proyecto/desarrollo /raiz/proyecto/sistemas /raiz/proyecto/desarrollo /raiz/proyecto/explotacion
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Creación de grupos:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo groupadd sistemas    
sudo groupadd desarrollo    
sudo groupadd explotacion    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Cambio de propietario de los directorios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chown root.sistemas /raiz/proyecto/sistemas    
sudo chown root.desarrollo /raiz/proyecto/desarrollo    
sudo chown root.explotacion /raiz/proyecto/explotacion    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Cambio de permisos a los directorios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chmod u+rwx,g+rwx,o-rwx /raiz/proyecto/sistemas    
sudo chmod u+rwx,g+rwx,o-rwx /raiz/proyecto/explotacion    
sudo chmod u+rwx,g+rwx,o-rwx /raiz/proyecto/desarrollo    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Captura de los directorios ya modificados:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="directorios" src="https://arpovea.vercel.app/images/UGO/capturadirectoriopermisospropietarios.png"&gt; &lt;/p&gt;
&lt;p&gt;Creación de usuarios y asignación a los grupos en la creación:&lt;/p&gt;
&lt;p&gt;Usuarios sistema1 y sistema2:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo useradd sistemas1 -m -G sistemas,desarrollo,explotacion -s /bin/bash
sudo useradd sistemas2 -m -G sistemas,desarrollo,explotacion -s /bin/bash
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Usuarios desarrollo1 y desarrollo2:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo useradd desarrollo1 -m -G desarrollo,explotacion -s /bin/bash
sudo useradd desarrollo2 -m -G desarrollo,explotacion -s /bin/bash
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Usuarios explotacion1 y explotacion2:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo useradd explotacion1 -m -G explotacion -s /bin/bash
sudo useradd explotacion2 -m -G explotacion -s /bin/bash
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Captura de los usuarios /etc/passwd:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="passwd" src="https://arpovea.vercel.app/images/UGO/passwd.png"&gt; &lt;/p&gt;
&lt;p&gt;Captura de los grupos /etc/group:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="group" src="https://arpovea.vercel.app/images/UGO/group.png"&gt; &lt;/p&gt;
&lt;p&gt;Recordamos que las opciones del comando usseradd son para los siguiente:  &lt;br&gt;
- "-m". Crea el directorio principal del usuario.  &lt;br&gt;
- "-G". Se asignan los grupos segundarios, separados por comas.  &lt;br&gt;
- "-s". Se asigna la shell por defecto que utiliza el usuario.    &lt;/p&gt;
&lt;p&gt;Asignar contraseñas a los usuarios:    &lt;/p&gt;
&lt;p&gt;No olvidemos que ahora mismo estos usuarios no pueden acceder a su cuenta ya que estas no tienen contraseña, para asignarles una, utilizar el comando passwd ejemplo:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo passwd sistemas1    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con esta configuración los usuarios cumplirán los requisitos que se enumeran en el enunciado de este post.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda. Un saludo.&lt;/p&gt;</content><category term="Sistemas"></category></entry><entry><title>FTP</title><link href="https://arpovea.vercel.app/ftp.html" rel="alternate"></link><published>2020-02-07T00:00:00+01:00</published><updated>2020-02-07T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-02-07:/ftp.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se va a descargar una imagen ISO de Debian del sitio "ftp.rediris.es", se analizará el tráfico con Wireshark y se comentarán algunas cosas.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se va a descargar una imagen ISO de Debian del sitio "ftp.rediris.es", se analizará el tráfico con Wireshark y se comentarán algunas cosas.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;FTP&lt;/h2&gt;
&lt;p&gt;Para conectarse al sitio "ftp.rediris.es", lo primero es tener el paquete ftp instalado en el equipo, para ello:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo aptitude update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; aptitude install -y ftp
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez instalado, con el siguiente comando te conectas al sitio "ftp.rediris.es":    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ftp ftp.rediris.es
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pide usuario, pero se puede dejar en blanco y continuar en Anonymous. Ahora entrarás en un prompt de FTP.    &lt;/p&gt;
&lt;p&gt;Con los comandos &lt;code&gt;ls&lt;/code&gt; y &lt;code&gt;cd&lt;/code&gt; se puede tanto listar el contenido como moverse por los distintos directorios, con el siguiente comando te posicionas en el directorio de la ISO que se va a descargar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; debian-cd/10.2.0/amd64/iso-cd/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Puedes comprobrar con el comando &lt;code&gt;pwd&lt;/code&gt; o con &lt;code&gt;ls&lt;/code&gt; que estas en el directorio correcto. Ahora se descarga la imagen con el siguiente comando:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;get debian-10.2.0-amd64-netinst.iso
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez realizado esto comanzará la descarga que dependerá de la velocidad de conexión de cada uno, una vez descargada esta se encontrará en el directorio actual donde comenzaste con los comandos FTP. Para salir de la línea de comandos FTP utiliza &lt;code&gt;exit&lt;/code&gt;.    &lt;/p&gt;
&lt;p&gt;A continución se muestran las capturas de Wireshark desde la primera conexión hasta el fin:    &lt;/p&gt;
&lt;p&gt;Conexiones Cliente-Servidor:  &lt;br&gt;
&lt;img alt="ftp1" src="https://arpovea.vercel.app/images/FTP/FTPWireshark.png"&gt;    &lt;/p&gt;
&lt;p&gt;Descarga imagen ISO:  &lt;br&gt;
&lt;img alt="ftp2" src="https://arpovea.vercel.app/images/FTP/DescargaISO.png"&gt;    &lt;/p&gt;
&lt;p&gt;Como se puede observar en las capturas de Wireshark el cliente mantiene una conversación con el servidor mediante los puertos "21" del servidor y el puerto "41416" del cliente, cuando inicia la descarga estos puertos cambian del "20" del servidor al "54117" del cliente. Esto significa que el modo de FTP esta en ACTIVO.    &lt;/p&gt;
&lt;p&gt;Recordemos la diferencia entre FTP activo y FTP pasivo:    &lt;/p&gt;
&lt;h3&gt;FTP activo (predeterminado)&lt;/h3&gt;
&lt;p&gt;En este modo el cliente se conecta desde un puerto aleatorio hacia el puerto "21" del servidor para la transferencia de un archivo, el servidor a tráves de su puerto "21" se pone en contacto con el cliente en el siguiente puerto del cliente es decir, si para la primera conexión el cliente utilizó el puerto "1500" el servidor se comunicará con el puerto "1501", aquí el servidor establece la conexión de datos por lo que si hay un firewall este rechazaría la conexión y sería imposible conectarse, ya que el servidor aquí es el que establece el canal de datos.    &lt;/p&gt;
&lt;p&gt;&lt;img alt="ftpactivo" src="https://arpovea.vercel.app/images/FTP/FTP-Modo-activo.jpg"&gt;    &lt;/p&gt;
&lt;h3&gt;FTP pasivo&lt;/h3&gt;
&lt;p&gt;En este modo el cliente se conecta al servidor de la misma manera solo que, el servidor le indica al cliente que tiene que conectarse a un puerto distinto del "20" para la descarga de datos, por lo que el cliente inicia una conexíon a un puerto aleatorio del servidor. Así el cliente es el que establece el canal de datos por lo que el firewall no rechazariá la conexión.     &lt;/p&gt;
&lt;p&gt;&lt;img alt="ftpasivo" src="https://arpovea.vercel.app/images/FTP/FTP-Modo-Pasivo-FTP.jpg"&gt;    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que sirva de ayuda. Un saludo.   &lt;/p&gt;</content><category term="Redes"></category></entry><entry><title>Hping3 y NetCat</title><link href="https://arpovea.vercel.app/hping3-y-netcat.html" rel="alternate"></link><published>2020-01-31T00:00:00+01:00</published><updated>2020-01-31T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-01-31:/hping3-y-netcat.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión vamos a probar un poco el comando Hping3 y  NetCat, con los cuales realizaremos pruebas en un escenario creado en una máquina virtual con Mininet. Probaremos a modificar los paquetes de ping y a conectarnos a distintos puertos y realizar varias conexiones.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión vamos a probar un poco el comando Hping3 y  NetCat, con los cuales realizaremos pruebas en un escenario creado en una máquina virtual con Mininet. Probaremos a modificar los paquetes de ping y a conectarnos a distintos puertos y realizar varias conexiones.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Mininet&lt;/h2&gt;
&lt;p&gt;A continuación se expondra el escenario y los comandos que se van a utilizar en esta práctica:    &lt;/p&gt;
&lt;p&gt;Esquema de escenario:    &lt;/p&gt;
&lt;p&gt;&lt;code&gt;10.0.100.0/24 -&amp;gt; h1, h2 y r1&lt;/code&gt;  &lt;br&gt;
&lt;code&gt;10.0.110.0/24 -&amp;gt; r1 y r2&lt;/code&gt;  &lt;br&gt;
&lt;code&gt;10.0.120.0/24 -&amp;gt; r2 y r3&lt;/code&gt;  &lt;br&gt;
&lt;code&gt;10.0.130.0/24 -&amp;gt; h3, h4  y r3&lt;/code&gt;    &lt;/p&gt;
&lt;p&gt;&lt;img alt="escenario" src="https://arpovea.vercel.app/images/Hping3yNetCat/escenario.png"&gt;&lt;/p&gt;
&lt;p&gt;Se dejan por aquí los enlaces a los scripts tanto del escenario como del despliegue en Mininet:    &lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/arpovea/arpovea.github.io/blob/master/assets/img/Hping3yNetCat/escenariotrasnporte2.mn"&gt;Scrip Escenario&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/arpovea/arpovea.github.io/blob/master/assets/img/Hping3yNetCat/escenariotrasnporte2.py"&gt;Scrip Despliegue&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Una vez desplegado el escenario los comandos para configurar la red en cada máquina son:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#H1 &lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.100.3/24 dev h1-eth0
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.100.1

&lt;span class="c1"&gt;#H2&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.100.4/24 dev h2-eth0
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.100.2

&lt;span class="c1"&gt;#R1&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.110.1/24 dev r1-eth0
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.100.1/24 dev r1-eth1
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.100.2/24 dev r1-eth2
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.110.2

&lt;span class="c1"&gt;#R2&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.110.2/24 dev r2-eth0
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.120.1/24 dev r2-eth1
ip r add &lt;span class="m"&gt;10&lt;/span&gt;.0.100.0/24 via &lt;span class="m"&gt;10&lt;/span&gt;.0.110.1
ip r add &lt;span class="m"&gt;10&lt;/span&gt;.0.130.0/24 via &lt;span class="m"&gt;10&lt;/span&gt;.0.120.2

&lt;span class="c1"&gt;#R3&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.120.2/24 dev r3-eth0
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.130.1/24 dev r3-eth1
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.130.2/24 dev r3-eth2
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.120.1

&lt;span class="c1"&gt;#H3&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.130.3/24 dev h3-eth0
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.130.1

&lt;span class="c1"&gt;#H4&lt;/span&gt;
ip a add &lt;span class="m"&gt;10&lt;/span&gt;.0.130.4/24 dev h4-eth0
ip r add default via &lt;span class="m"&gt;10&lt;/span&gt;.0.130.2
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;HPing3&lt;/h2&gt;
&lt;p&gt;Ahora se va a realizar con el comando HPing3 un Echo Request desde H1 hacia H4 capturando el tráfico en R3 con Wireshark:    &lt;/p&gt;
&lt;p&gt;Comando H1:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hping3 -K &lt;span class="m"&gt;0&lt;/span&gt; -c &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.0.130.4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;La opción -K indica que utilice Echo Request, este vendria por defecto pero con esto se le especifica.  &lt;br&gt;
La opción -c indica el número de paquetes que se enviarán en este caso "5".     &lt;/p&gt;
&lt;p&gt;Estas son las capturas realizadas con Wireshark en R3:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="echorequest1" src="https://arpovea.vercel.app/images/Hping3yNetCat/capturaechorequest1.png"&gt;  &lt;br&gt;
&lt;img alt="echorequest2" src="https://arpovea.vercel.app/images/Hping3yNetCat/capturaechorequest2.png"&gt;    &lt;/p&gt;
&lt;p&gt;A continución cambiaremos la TTL para que no sea alcanzable H4:    &lt;/p&gt;
&lt;p&gt;Comando H1:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hping -K &lt;span class="m"&gt;0&lt;/span&gt; --ttl &lt;span class="m"&gt;3&lt;/span&gt; -c &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.0.130.4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;La opcion --ttl cambia por defecto la ttl de "64"(por defecto) en "3" en este caso.&lt;/p&gt;
&lt;p&gt;&lt;img alt="TTL" src="https://arpovea.vercel.app/images/Hping3yNetCat/TTL.png"&gt;&lt;/p&gt;
&lt;p&gt;Como se puede observar en la imagen no llega a su destino.    &lt;/p&gt;
&lt;p&gt;Ahora se intentará realizar una conexion desde el puerto "4000" al puerto "80" desde H1:   &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;hping3 -s &lt;span class="m"&gt;4000&lt;/span&gt; -p &lt;span class="m"&gt;80&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.0.130.4
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;La opción -s indica el puerto base.  &lt;br&gt;
La opción -p indica el puerto destino.    &lt;/p&gt;
&lt;p&gt;Capturas en Wireshark:&lt;/p&gt;
&lt;p&gt;&lt;img alt="TCP4000-1" src="https://arpovea.vercel.app/images/Hping3yNetCat/capturaTCP4000-1.png"&gt;  &lt;br&gt;
&lt;img alt="TCP4000-2" src="https://arpovea.vercel.app/images/Hping3yNetCat/capturaTCP4000-2.png"&gt;    &lt;/p&gt;
&lt;p&gt;Como se puede observar al no estar el puerto "80" activo se recibe la etiqueta [RST,ACK] que indica que no hay nada en ese puerto, si hubiera un servicio en ese puerto escuchando se mostraría la etiqueta [SYN,ACK].    &lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;NetCat&lt;/h2&gt;
&lt;p&gt;Con NetCat se creara un servidor TCP en el puerto "80" de H3 y se realizará una conexión desde H2, se capturará el tráfico con Wireshark en R3:    &lt;/p&gt;
&lt;p&gt;Comando para el servidor TCP en H3:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc -l &lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Comando para realizar la conexión desde H2:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc &lt;span class="m"&gt;10&lt;/span&gt;.0.130.3 &lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación se escribe en H2 y aparecerá en H3 como muestra la siguiente imagen:&lt;/p&gt;
&lt;p&gt;&lt;img alt="TCPconexion" src="https://arpovea.vercel.app/images/Hping3yNetCat/TCPconexion.png"&gt;    &lt;/p&gt;
&lt;p&gt;Capturas de Wireshark:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="netcap1" src="https://arpovea.vercel.app/images/Hping3yNetCat/netcap1.png"&gt;  &lt;br&gt;
&lt;img alt="netcap2" src="https://arpovea.vercel.app/images/Hping3yNetCat/netcat2.png"&gt;  &lt;br&gt;
&lt;img alt="mensaje1" src="https://arpovea.vercel.app/images/Hping3yNetCat/mensaje1psh.png"&gt;  &lt;br&gt;
&lt;img alt="mensaje2" src="https://arpovea.vercel.app/images/Hping3yNetCat/mensaje2psh.png"&gt;    &lt;/p&gt;
&lt;p&gt;Como se puede obsevar en estas capturas se ve la conexión TCP con la etiqueta [SYN,ACK] y luego los mensajes enviados con la etiqueta [PSH,ACK].    &lt;/p&gt;
&lt;p&gt;Ahora se cerrara la conexión y se mostrará la secuencia de cierre con Wireshark:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="secuenciadecerrado" src="https://arpovea.vercel.app/images/Hping3yNetCat/secuenciadecerrado.png"&gt;    &lt;/p&gt;
&lt;p&gt;Aquí se observa la etiqueta [FIN,ACK] y sus respectivas respuestas, indicando el cierre de la conexión.    &lt;/p&gt;
&lt;p&gt;Probaremos a realizar lo mismo pero con un servidor UDP en vez de TCP, esta vez el servidor en H1 y la conexión desde H4:    &lt;/p&gt;
&lt;p&gt;Comando para el servidor UDP en H1:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc -u -l &lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Comando para realizar la conexión UDP desde H4:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc -u &lt;span class="m"&gt;10&lt;/span&gt;.0.130.3 &lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A continuación se escribe en H4 y aparecerá en H1 como muestra la siguiente imagen:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="UDPconexion" src="https://arpovea.vercel.app/images/Hping3yNetCat/UDPconexion.png"&gt;    &lt;/p&gt;
&lt;p&gt;Capturas de Wireshark:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="UDP1" src="https://arpovea.vercel.app/images/Hping3yNetCat/Netcatudp1.png"&gt;  &lt;br&gt;
&lt;img alt="UDP2" src="https://arpovea.vercel.app/images/Hping3yNetCat/netcapUDP2.png"&gt;    &lt;/p&gt;
&lt;p&gt;Con el protocolo UDP no se comprueban las mismas cosas que con el protocolo TCP, la única ventaja de UDP es que es más liviano y en algunas ocasiones tiene sus ventajas. Como se puede observar solo están los mensajes enviados desde H4 hacia H1.    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que sirva de ayuda. Un saludo.    &lt;/p&gt;</content><category term="Redes"></category></entry><entry><title>Probando Dig y Wireshark</title><link href="https://arpovea.vercel.app/probando-dig-y-wireshark.html" rel="alternate"></link><published>2020-01-28T00:00:00+01:00</published><updated>2020-01-28T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-01-28:/probando-dig-y-wireshark.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión vamos a probar un poco el comando dig y el programa Wireshark, con los cuales realizaremos consultas DNS e investigaremos un poco el tráfico de una petición a una página web.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión vamos a probar un poco el comando dig y el programa Wireshark, con los cuales realizaremos consultas DNS e investigaremos un poco el tráfico de una petición a una página web.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;DIG&lt;/h2&gt;
&lt;p&gt;Se va a realizar una petición DNS con el comando dig a las páginas www.marca.com y www.elmundo.es:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dig www.marca.com
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Captura de pantalla correspondiente:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="dig1" src="https://arpovea.vercel.app/images/DigyWireshark/digmarca.png"&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dig www.elmundo.com
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Captura de pantalla correspondiente:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="dig2" src="https://arpovea.vercel.app/images/DigyWireshark/digelmundo.png"&gt;     &lt;/p&gt;
&lt;p&gt;Como se puede observar en las imágenes ambas webs estan alojadas en el servidor &lt;code&gt;151.101.133.50&lt;/code&gt; con el CNAME(alias del dominio) "unidadeditorial.map.fastly.net".    &lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Wireshark&lt;/h2&gt;
&lt;p&gt;A continuación se realiza una captura del tráfico con Wireshark accediendo al sitio www.marca.com.
En ella podemos observar lo siguiente:&lt;/p&gt;
&lt;p&gt;La petición y respuesta DNS:&lt;/p&gt;
&lt;p&gt;&lt;img alt="dns1" src="https://arpovea.vercel.app/images/DigyWireshark/capturadnsmarca1.png"&gt;
&lt;img alt="dns2" src="https://arpovea.vercel.app/images/DigyWireshark/capturadns2.png"&gt;
&lt;img alt="dns3" src="https://arpovea.vercel.app/images/DigyWireshark/capturadns3.png"&gt;&lt;/p&gt;
&lt;p&gt;La primera conexión TSL, puesto que es una página que tiene seguridad HTTPS, con esto el cliente le pide los certificados a la página para poder conectarse de forma segura:    &lt;/p&gt;
&lt;p&gt;Mensajes del cliente:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="TSL1" src="https://arpovea.vercel.app/images/DigyWireshark/clienthellow1.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="TSL2" src="https://arpovea.vercel.app/images/DigyWireshark/clienthellow2.png"&gt;&lt;/p&gt;
&lt;p&gt;Mensajes del servidor:    &lt;/p&gt;
&lt;p&gt;&lt;img alt="TSL3" src="https://arpovea.vercel.app/images/DigyWireshark/serverhellow.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="TSL4" src="https://arpovea.vercel.app/images/DigyWireshark/serverhellow2.png"&gt;&lt;/p&gt;
&lt;p&gt;Ya que es una página con seguridad HTTPS no podemos sacar mucha información, de todas formas dejo por aquí los filtros de Wireshark para páginas HTTP:   &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Protocolo&lt;/span&gt; &lt;span class="n"&gt;HTTP&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;host&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;google&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Queremos&lt;/span&gt; &lt;span class="n"&gt;ver&lt;/span&gt; &lt;span class="n"&gt;los&lt;/span&gt; &lt;span class="n"&gt;paquetes&lt;/span&gt; &lt;span class="n"&gt;que&lt;/span&gt; &lt;span class="n"&gt;tengan&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;Google&lt;/span&gt; &lt;span class="n"&gt;como&lt;/span&gt; &lt;span class="k"&gt;host&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nb"&gt;date&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;Wed&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt; &lt;span class="n"&gt;Mar&lt;/span&gt; &lt;span class="mi"&gt;2011&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt; &lt;span class="n"&gt;GMT&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Paquetes&lt;/span&gt; &lt;span class="n"&gt;con&lt;/span&gt; &lt;span class="n"&gt;respecto&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;una&lt;/span&gt; &lt;span class="n"&gt;fecha&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Según&lt;/span&gt; &lt;span class="n"&gt;el&lt;/span&gt; &lt;span class="n"&gt;tipo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Hay&lt;/span&gt; &lt;span class="n"&gt;más&lt;/span&gt; &lt;span class="n"&gt;tipos&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;png&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Imágenes&lt;/span&gt; &lt;span class="n"&gt;PNG&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;gif&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Imágenes&lt;/span&gt; &lt;span class="n"&gt;GIF&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jpeg&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Imágenes&lt;/span&gt; &lt;span class="n"&gt;JPEG&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="nb"&gt;text&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Archivos&lt;/span&gt; &lt;span class="n"&gt;HTML&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="nb"&gt;text&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;css&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Hojas&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;estilo&lt;/span&gt; &lt;span class="n"&gt;CSS&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;video&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;quicktime&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Vídeos&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;zip&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Archivos&lt;/span&gt; &lt;span class="n"&gt;ZIP&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;method&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="k"&gt;GET&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Tipo&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;Petición&lt;/span&gt; &lt;span class="k"&gt;GET&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;method&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Tipo&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;Petición&lt;/span&gt; &lt;span class="n"&gt;POST&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_agent&lt;/span&gt; &lt;span class="k"&gt;contains&lt;/span&gt; &lt;span class="err"&gt;“&lt;/span&gt;&lt;span class="n"&gt;Mozilla&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Navegador&lt;/span&gt; &lt;span class="n"&gt;Mozilla&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;!=*&lt;/span&gt;&lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Con&lt;/span&gt; &lt;span class="n"&gt;esto&lt;/span&gt; &lt;span class="n"&gt;me&lt;/span&gt; &lt;span class="n"&gt;libro&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;los&lt;/span&gt; &lt;span class="n"&gt;paquetes&lt;/span&gt; &lt;span class="err"&gt;“&lt;/span&gt;&lt;span class="k"&gt;NOTIFY&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;HTTP&lt;/span&gt;&lt;span class="err"&gt;…”&lt;/span&gt;

&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="n"&gt;matches&lt;/span&gt; &lt;span class="err"&gt;“&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="err"&gt;”&lt;/span&gt; &lt;span class="err"&gt;—&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Uso&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;expresiones&lt;/span&gt; &lt;span class="n"&gt;regulares&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Estos son solo algunos ejemplos. ¡Existen muchos mas!    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí, espero que sirva de ayuda. Nos vemos en el siguiente post.&lt;/p&gt;</content><category term="Redes"></category></entry><entry><title>Swap-Añadiendo espacio de intercambio a nuestra máquina.</title><link href="https://arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html" rel="alternate"></link><published>2020-01-26T00:00:00+01:00</published><updated>2020-01-26T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-01-26:/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html</id><summary type="html">&lt;p&gt;Buenas! En esta ocasión se añadirá espacio de intercambio (SWAP) a través de un volumen, y de un fichero, en este Post se verán ambos casos. Recordad que para esta práctica se está utilizando una máquina con Debian 10.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! En esta ocasión se añadirá espacio de intercambio (SWAP) a través de un volumen, y de un fichero, en este Post se verán ambos casos. Recordad que para esta práctica se está utilizando una máquina con Debian 10.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Primer caso: Añadiendo SWAP con un volumen.&lt;/h2&gt;
&lt;p&gt;Suponiendo que se haya conectado un volumen a la máquina, se le creará la partición y se le dará formato a esta para que sea apta para SWAP. (En este caso el volumen tiene 1 GB.)  &lt;br&gt;
Para ello se crea la partición con: (El volumen tiene asignado las letras "sdb" en este caso.)    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo fdisk /dev/sdb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dentro del fdisk utiliza la opción "n" para crear la partición y la opción "w" para guardar y aplicar los cambios.  &lt;br&gt;
Luego se le da formato con &lt;code&gt;mkswap&lt;/code&gt; y se le añade una etiqueta con la opción "-L" para que sea mas fácil identificarla: (La partición del volumen ha tomado el nombre "sdb1".)    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mkswap -L swap1 /dev/sdb1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con el comando &lt;code&gt;lsblk -f&lt;/code&gt; puedes observar que los cambios estén bien hechos.    &lt;/p&gt;
&lt;p&gt;Una vez el volumen esta preparado para ser utilizado, hay que enteder un poco como gestiona Linux el tema de la SWAP:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Quien decide el momento en que se empiezan a trasvasar imágenes de procesos de la RAM a la Swap es el Kernel. Como Linux es un sistema operativo abierto podemos hacer que el Kernel de Linux esperé hasta cuando la memoria RAM este casi llena para que empezar el trasvase. Tan solo tenemos que modificar el valor de swappiness de nuestro sistema operativo para indicarle al kernel de linux que de más prioridad al uso de RAM que al uso de Swap.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;En el fichero &lt;code&gt;/proc/sys/vm/swappiness&lt;/code&gt; hay un valor entre 0 y 100 por defecto tiene un valor de 60. (100-60=40% uso de RAM):
- El valor 0 evitará el intercambio de información entre la RAM y la swap .
- El valor 100 el intercambio se estará realizando constantemente.&lt;/p&gt;
&lt;p&gt;Se le puede dar un valor con el comando:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt; &amp;gt; /proc/sys/vm/swappiness
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esto sin embargo no será permanente, para realizar un cambio permanente tendremos que añadir en el fichero &lt;code&gt;/etc/sysctl.conf&lt;/code&gt; la linea &lt;code&gt;vm.swappiness=90&lt;/code&gt;    &lt;/p&gt;
&lt;p&gt;Una vez entendido lo básico y teniendo el volumen preparado, se puede activar la zona de intercambio de la siguiente forma:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo swapon /dev/sdb1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(Con el valor -p se puede modificar el orden de prioridad con el que se activa esta SWAP, en el caso que hubiera más de una.)  &lt;br&gt;
Para desactivarla sería:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo swapoff /dev/sdb1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;(Si la SWAP se esta utilizando no se podria desactivar.)    &lt;/p&gt;
&lt;p&gt;Para ver el estado de la SWAP activas se realiza:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo swapon -s ó cat /proc/swaps
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Con el comando &lt;code&gt;lsblk -f&lt;/code&gt; se puede observar en el punto de montaje de "sdb1" la etiqueta [SWAP].    &lt;/p&gt;
&lt;p&gt;Esto sin embargo es temporal puesto que al reiniciar la máquina, esta SWAP se desmontará, para que esto se monte en cada inicio del sistema hay que utilizar el fichero &lt;code&gt;/etc/fstab&lt;/code&gt;.    &lt;/p&gt;
&lt;p&gt;Añadiendo la siguiente línea se montaría en el inicio:  &lt;br&gt;
&lt;code&gt;/dev/vdb2  swap    swap    defaults    0   0&lt;/code&gt;    &lt;/p&gt;
&lt;p&gt;Con el siguiente comando se montarían todas las zonas SWAP definidas en &lt;code&gt;/etc/fstab&lt;/code&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;swapon -a
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h2&gt;Segundo caso: Añadiendo SWAP con un fichero.&lt;/h2&gt;
&lt;p&gt;Se crea el fichero /swap con el siguiente comando: (en este caso de 64 MB)    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/zero &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/swap &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1024&lt;/span&gt; &lt;span class="nv"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;65536&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se le da formato SWAP con:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo mkswap /swap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se le asignan permiso de lectura y escritura:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chmod &lt;span class="m"&gt;600&lt;/span&gt; /swap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para activarla se utiliza:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo swapon /swap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para ver las swap activa:    &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo swapon -s ó free &lt;span class="p"&gt;|&lt;/span&gt; grep Swap
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para que inicie con el sistema añadimos la siguiente línea al fichero &lt;code&gt;/etc/fstab&lt;/code&gt;:  &lt;br&gt;
&lt;code&gt;/swap  swap   swap   defaults      0   0&lt;/code&gt;    &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;En estos dos sencillos pasos se ha visto como añadir SWAP a nuestra máquina. Un saludo    &lt;/p&gt;</content><category term="Sistemas"></category></entry><entry><title>AutoFS</title><link href="https://arpovea.vercel.app/autofs.html" rel="alternate"></link><published>2020-01-25T00:00:00+01:00</published><updated>2020-01-25T00:00:00+01:00</updated><author><name>Adrián Rodríguez Povea</name></author><id>tag:arpovea.vercel.app,2020-01-25:/autofs.html</id><summary type="html">&lt;p&gt;Buenas! Para inaugurar el Blog empezaremos con una pequeña práctica para automontar un volumen en una máquina con Debian 10 utilizando autofs.&lt;/p&gt;</summary><content type="html">&lt;hr&gt;
&lt;p&gt;Buenas! Para inaugurar el Blog empezaremos con una pequeña práctica para automontar un volumen en una máquina con Debian 10 utilizando autofs.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Lo primero que se va a realizar es la instalación del servicio autofs:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt install autofs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Comprobamos que servicio este activo con:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl status autofs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;En el caso de que no lo este utiliza:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl start autofs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Este servicio consta de un fichero maestro de configuración que se encuentra en &lt;code&gt;/etc/auto.master&lt;/code&gt; y otro fichero que se creara por punto de montaje &lt;code&gt;/etc/auto.nombre&lt;/code&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;El fichero &lt;code&gt;auto.master&lt;/code&gt; sigue el siguiente formato:  &lt;br&gt;
&lt;strong&gt;&lt;em&gt;directorio_raiz | archivo secundario | --opciónes de montaje=valor&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Ejemplo: &lt;code&gt;/DATOS/dinamico  /etc/auto.dinamico  --timeout=2,sync,nodev,nosuid&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;El fichero &lt;code&gt;auto.nombre&lt;/code&gt;sigue el siguiente (en este caso se ha llamado &lt;code&gt;auto.dinamico&lt;/code&gt;):
&lt;strong&gt;&lt;em&gt;nombre_de_la_carpeta_que_se_montará | tipo_de_fs | UUID_del_volumen&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Ejemplo: &lt;code&gt;primero -fstype=ext3 UUID=3ab3f16b-b1d3-4c8c-ad87-ddb37fc62eb2&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;El UUID del dispositivo se puede obtener con el siguiente comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lsblk -no UUID /dev/vdc1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez esten los ficheros configurados hay que reiniciar el servicio de Autofs para que cargue los cambios realizados:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;systemctl restart autofs
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se puede crear un enlace para acceder directamente a este volumen por ejemplo en el home:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ln -s /DATOS/dinamico/primero enlacevolumenprimero
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez creado el enlace realizamos el siguiente comando para acceder al volumen:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; enlacevolumenprimero
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para ver que esta montado donde deseas ejecuta:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;lsblk -f
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Lo cual te listara todos los dispositivos de bloque de tu máquina y su punto de montaje.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Muchas gracias por leer hasta aquí espero que haya servido de ayuda.Un saludo.&lt;/p&gt;</content><category term="Sistemas"></category></entry></feed>