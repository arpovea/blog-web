<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Swap-Añadiendo espacio de intercambio a nuestra máquina. &ndash; Blog Informático</title>

    <!-- Meta -->
    <meta name="description" content="Blog Informático &ndash; ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Social -->
    <meta property="article:author" content="Adrián Rodríguez Povea" />
    <meta property="article:section" content="Sistemas" />
    <meta property="article:published_time" content="2020-01-26" />

    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Swap-Añadiendo espacio de intercambio a nuestra máquina."/>
    <meta property="og:description" content="Buenas! En esta ocasión se añadirá espacio de intercambio (SWAP) a través de un volumen, y de un fichero, en este Post se verán ambos casos. Recordad que para esta práctica se está utilizando una máquina con Debian 10."/>
    <meta property="og:site_name" content="Blog Informático" />
    <meta property="og:url" content="https://arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html"/>

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Swap-Añadiendo espacio de intercambio a nuestra máquina.">
    <meta name="twitter:description" content="Buenas! En esta ocasión se añadirá espacio de intercambio (SWAP) a través de un volumen, y de un fichero, en este Post se verán ambos casos. Recordad que para esta práctica se está utilizando una máquina con Debian 10.">
    <meta name="twitter:url" content="https://arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html">

    <!-- Feed -->
    <link rel="alternate" type="application/atom+xml" href="https://arpovea.vercel.app/feeds/all.atom.xml" title="Blog Informático Atom Feed" />
    <link rel="alternate" type="application/atom+xml" href="https://arpovea.vercel.app/feeds/Sistemas.atom.xml" title="Blog Informático Categories Atom Feed" />
    <link rel="alternate" type="application/rss+xml" href="http://arpovea.disqus.com/latest.rss" title="Blog Informático Comments RSS Feed">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:regular,bold">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/theme/css/w3.css">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/theme/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/theme/css/jqcloud.css">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/theme/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/theme/css/pygments-highlight-github.css">
    <link rel="stylesheet" type="text/css" href="https://arpovea.vercel.app/static/custom.css">

    <!-- Icon -->
    <link rel="shortcut icon" type="image/x-icon" href="https://arpovea.vercel.app/theme/images/arpovealogo.PNG">

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://arpovea.vercel.app/theme/js/jqcloud.min.js"></script>
  </head>

  <body>
    <div class="w3-row w3-card w3-white">
      <header id="header">
        <a href="https://arpovea.vercel.app" id="header-logo" title="Home">AR</a>
        <nav id="header-menu">
          <ul>
            <!--<li class="w3-bottombar w3-border-white w3-hover-border-green" ><a href="https://arpovea.vercel.app/category/redes.html">Redes</a></li>-->
            <!--<li class="w3-bottombar w3-border-white w3-hover-border-green" ><a href="https://arpovea.vercel.app/category/seguridad.html">Seguridad</a></li>-->
            <!--<li class="w3-bottombar w3-border-white w3-hover-border-green" ><a href="https://arpovea.vercel.app/category/servicios.html">Servicios</a></li>-->
            <!--<li class="w3-bottombar w3-border-white w3-hover-border-green" style="font-weight: bold;"><a href="https://arpovea.vercel.app/category/sistemas.html">Sistemas</a></li>-->
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="/categories.html">Categorías</a></li>
            <li class="w3-bottombar w3-border-white w3-hover-border-green"><a href="/archives.html">Artículos</a></li>
            <li><a href="https://arpovea.vercel.app/pages/acerca-de.html">Acerca de</a></li>
          </ul>
        </nav>
      </header>
    </div>



    <br><br><br>

    <article>
      <header class="w3-container col-main">
        <h1>Swap-Añadiendo espacio de intercambio a nuestra máquina.</h1>
        <div class="post-info">
          <div class="w3-opacity w3-margin-right w3-margin-bottom" style="flex-grow: 1;">
            <span><time datetime="2020-01-26T00:00:00+01:00">dom 26 enero 2020</time> en <a href="https://arpovea.vercel.app/category/sistemas.html" title="All articles in category Sistemas">Sistemas</a></span>
          </div>
        </div>
      </header>

      <br>


      <div class="col-main w3-container">
        <section id="content">
          <hr>
<p>Buenas! En esta ocasión se añadirá espacio de intercambio (SWAP) a través de un volumen, y de un fichero, en este Post se verán ambos casos. Recordad que para esta práctica se está utilizando una máquina con Debian 10.</p>
<hr>
<h2>Primer caso: Añadiendo SWAP con un volumen.</h2>
<p>Suponiendo que se haya conectado un volumen a la máquina, se le creará la partición y se le dará formato a esta para que sea apta para SWAP. (En este caso el volumen tiene 1 GB.)  <br>
Para ello se crea la partición con: (El volumen tiene asignado las letras "sdb" en este caso.)    </p>
<div class="highlight"><pre><span></span>sudo fdisk /dev/sdb
</pre></div>


<p>Dentro del fdisk utiliza la opción "n" para crear la partición y la opción "w" para guardar y aplicar los cambios.  <br>
Luego se le da formato con <code>mkswap</code> y se le añade una etiqueta con la opción "-L" para que sea mas fácil identificarla: (La partición del volumen ha tomado el nombre "sdb1".)    </p>
<div class="highlight"><pre><span></span>sudo mkswap -L swap1 /dev/sdb1
</pre></div>


<p>Con el comando <code>lsblk -f</code> puedes observar que los cambios estén bien hechos.    </p>
<p>Una vez el volumen esta preparado para ser utilizado, hay que enteder un poco como gestiona Linux el tema de la SWAP:</p>
<blockquote>
<p>Quien decide el momento en que se empiezan a trasvasar imágenes de procesos de la RAM a la Swap es el Kernel. Como Linux es un sistema operativo abierto podemos hacer que el Kernel de Linux esperé hasta cuando la memoria RAM este casi llena para que empezar el trasvase. Tan solo tenemos que modificar el valor de swappiness de nuestro sistema operativo para indicarle al kernel de linux que de más prioridad al uso de RAM que al uso de Swap.</p>
</blockquote>
<p>En el fichero <code>/proc/sys/vm/swappiness</code> hay un valor entre 0 y 100 por defecto tiene un valor de 60. (100-60=40% uso de RAM):
- El valor 0 evitará el intercambio de información entre la RAM y la swap .
- El valor 100 el intercambio se estará realizando constantemente.</p>
<p>Se le puede dar un valor con el comando:    </p>
<div class="highlight"><pre><span></span>sudo <span class="nb">echo</span> <span class="m">10</span> &gt; /proc/sys/vm/swappiness
</pre></div>


<p>Esto sin embargo no será permanente, para realizar un cambio permanente tendremos que añadir en el fichero <code>/etc/sysctl.conf</code> la linea <code>vm.swappiness=90</code>    </p>
<p>Una vez entendido lo básico y teniendo el volumen preparado, se puede activar la zona de intercambio de la siguiente forma:    </p>
<div class="highlight"><pre><span></span>sudo swapon /dev/sdb1
</pre></div>


<p>(Con el valor -p se puede modificar el orden de prioridad con el que se activa esta SWAP, en el caso que hubiera más de una.)  <br>
Para desactivarla sería:    </p>
<div class="highlight"><pre><span></span>sudo swapoff /dev/sdb1
</pre></div>


<p>(Si la SWAP se esta utilizando no se podria desactivar.)    </p>
<p>Para ver el estado de la SWAP activas se realiza:    </p>
<div class="highlight"><pre><span></span>sudo swapon -s ó cat /proc/swaps
</pre></div>


<p>Con el comando <code>lsblk -f</code> se puede observar en el punto de montaje de "sdb1" la etiqueta [SWAP].    </p>
<p>Esto sin embargo es temporal puesto que al reiniciar la máquina, esta SWAP se desmontará, para que esto se monte en cada inicio del sistema hay que utilizar el fichero <code>/etc/fstab</code>.    </p>
<p>Añadiendo la siguiente línea se montaría en el inicio:  <br>
<code>/dev/vdb2  swap    swap    defaults    0   0</code>    </p>
<p>Con el siguiente comando se montarían todas las zonas SWAP definidas en <code>/etc/fstab</code>. </p>
<div class="highlight"><pre><span></span>swapon -a
</pre></div>


<hr>
<h2>Segundo caso: Añadiendo SWAP con un fichero.</h2>
<p>Se crea el fichero /swap con el siguiente comando: (en este caso de 64 MB)    </p>
<div class="highlight"><pre><span></span>sudo dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/swap <span class="nv">bs</span><span class="o">=</span><span class="m">1024</span> <span class="nv">count</span><span class="o">=</span><span class="m">65536</span>
</pre></div>


<p>Se le da formato SWAP con:    </p>
<div class="highlight"><pre><span></span>sudo mkswap /swap
</pre></div>


<p>Se le asignan permiso de lectura y escritura:    </p>
<div class="highlight"><pre><span></span>sudo chmod <span class="m">600</span> /swap
</pre></div>


<p>Para activarla se utiliza:    </p>
<div class="highlight"><pre><span></span>sudo swapon /swap
</pre></div>


<p>Para ver las swap activa:    </p>
<div class="highlight"><pre><span></span>sudo swapon -s ó free <span class="p">|</span> grep Swap
</pre></div>


<p>Para que inicie con el sistema añadimos la siguiente línea al fichero <code>/etc/fstab</code>:  <br>
<code>/swap  swap   swap   defaults      0   0</code>    </p>
<hr>
<p>En estos dos sencillos pasos se ha visto como añadir SWAP a nuestra máquina. Un saludo    </p>
        </section>

        <br><br><br>

        <footer>
          <div class="adjust-width">
            <div id="author-block" class="w3-light-grey w3-border">
              <div id="author-info">
                <a href="http://arpovea.vercel.app"><img style="width: 60px; height: 60px;" src="theme/images/arpovealogo.PNG" onerror="this.src='theme/images/avatar.png'" alt="Avatar"></a>
                <div style="margin-left: 20px; margin-top: 15px;">
                  <a href="http://arpovea.vercel.app"><span id="author-name" class="w3-hover-text-dark-grey">Adrián Rodríguez Povea</span></a>
                  <p id="author-story">Apasionado de las tecnologías.</p>
                </div>
              </div>
            </div>
          </div>

          <br><br><br>

          <p style="font-size:10pt; font-style: italic;">¿Te ha gustado el artículo? ¡Compartelo!</p>
          <div id="share" class="share">
            <a href="http://www.facebook.com/sharer.php?u=https%3A//arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html&amp;t=Blog%20Inform%C3%A1tico%3A%20Swap-A%C3%B1adiendo%20espacio%20de%20intercambio%20a%20nuestra%20m%C3%A1quina." target="_blank" class="w3-btn w3-indigo">
              <i class="fa fa-facebook"></i> <span>Facebook</span>
            </a>
            <a href="http://twitter.com/share?url=https%3A//arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html&amp;text=Blog%20Inform%C3%A1tico%3A%20Swap-A%C3%B1adiendo%20espacio%20de%20intercambio%20a%20nuestra%20m%C3%A1quina." target="_blank" class="w3-btn w3-blue">
              <i class="fa fa-twitter"></i> <span>Twitter</span>
            </a>
            <a href="https://plus.google.com/share?url=https%3A//arpovea.vercel.app/swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina.html" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="w3-btn w3-red">
              <i class="fa fa-google-plus"></i> <span>Google</span>
            </a>
          </div>

          <br><br><br>


<!--                    <div id="disqus_thread"></div>
          <script>
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
            
            var disqus_config = function () {
              this.page.url = 'https://arpovea.vercel.app';  // Replace PAGE_URL with your page's canonical URL variable
              this.page.identifier = 'swap-anadiendo-espacio-de-intercambio-a-nuestra-maquina'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            
            (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
              var d = document, s = d.createElement('script');
              
              s.src = 'https://arpovea.disqus.com/embed.js';  // IMPORTANT: Replace EXAMPLE with your forum shortname!
              
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
            })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
          <br><br><br>
-->

        </footer>
      </div>
    </article>


    <footer id="footer">
      <div id="footer-copyright" class="w3-center w3-small w3-text-grey w3-padding-48">
        <span>&copy;  Adrián Rodríguez Povea</span>
      </div>
    </footer>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-12345678-9', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>